<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NCEPLIBS-w3emc: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ccpp_dox_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ncep.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NCEPLIBS-w3emc
   &#160;<span id="projectnumber">Version2.4.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__Users_valbona_NCEP_Library_all-3w3emc_README.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><em>Code Manager: Boi Vuong</em></p>
<p><em>libver=w3emc_v2.4.0</em></p>
<h2>Instructions for building and installing w3emc on Unix</h2>
<p>dependent library: NEMSIO, SIGIO, and NetCDF must be load before build </p><pre class="fragment">./build_w3emc.sh dell|cray|wcoss|theia|hera|gaea|jet|intel_general|gnu_general libver=&lt;lib_ver&gt; [debug] [compileonly] [prefix=&lt;installpath&gt;]
</pre><p><em>History</em></p>
<h4>nceplibs support email: <a href="#" onclick="location.href='mai'+'lto:'+'nce'+'p.'+'lis'+'t.'+'emc'+'.n'+'cep'+'li'+'bs.'+'su'+'ppo'+'rt'+'@no'+'aa'+'.go'+'v'; return false;">ncep.<span style="display: none;">.nosp@m.</span>list<span style="display: none;">.nosp@m.</span>.emc.<span style="display: none;">.nosp@m.</span>ncep<span style="display: none;">.nosp@m.</span>libs.<span style="display: none;">.nosp@m.</span>supp<span style="display: none;">.nosp@m.</span>ort@n<span style="display: none;">.nosp@m.</span>oaa.<span style="display: none;">.nosp@m.</span>gov</a></h4>
<h2>A. The easy (I hope) way...</h2>
<p>The "make_w3emc_lib.sh" script builds the single (_4), double (_8), and mixed (_d) precision w3emc libraries using the sigio and nemsio include and library values defined in the SIGIO_INC4, NEMSIO_INC, SIGIO_LIB4, and NEMSIO_LIB environment variables (envars).</p>
<h3>1. Defining the SIGIO_INC4, NEMSIO_INC, SIGIO_LIB4, and NEMSIO_LIB variables</h3>
<p>On WCOSS these envars can be set via the command, </p><pre class="fragment">$ module load sigio
$ module load nemsio
</pre><p>On CRAY these envars can be set via the command, </p><pre class="fragment">$ module load sigio-intel
$ module load nemsio-intel
</pre><p>You can get access to the production modulefiles via the following command on WCOSS: </p><pre class="fragment">$ module use -a /nwprod/lib/modulefiles
</pre><p>If you want to use different envar values you can specify them explicity, e.g. </p><pre class="fragment">$ export SIGIO_INC4="-I/path/to/incmod"
$ export SIGIO_LIB4="/path/to/libsigio_to-use.a"
$ export NEMSIO_INC="-I/path/to/incmod"
$ export NEMSIO_LIB="/path/to/libnemsio_to-use.a"
</pre><h2>2. Running the master build script</h2>
<p>Once the sigio and nemsio library envars have been defined, you can use the "make_w3emc_lib.sh" script specifying the build configuration. To get usage information for the script, type </p><pre class="fragment">$ make_w3emc_lib.sh -h
</pre><p>The available build configurations are: </p><pre class="fragment">gfortran-debug.setup  ifort-debug.setup  pgf95-debug.setup  xlf2003-debug.setup
gfortran.setup        ifort.setup        pgf95.setup        xlf2003.setup
wcoss.setup
</pre><p>The "wcoss.setup" is simply a link to the "ifort.setup" file.</p>
<p>So, on WCOSS you would type: </p><pre class="fragment">$ make_w3emc_lib.sh wcoss.setup
</pre><p>This script iterates over the single (_4), double (_8), and mixed (_d) precision build configurations setting the appropriate default real and integer precision promotion compiler switches.</p>
<p>Some additional points:</p><ul>
<li>The "NCO-type" install is performed by default.</li>
<li>The libraries are installed relative to the current directory. After running the script you should see two new directories containing the single (4), double (8), and mixed (d) precision libraries.</li>
<li>See section B.4 below for information about the installation directory structure</li>
</ul>
<p>You can tailor the build process using this "make_w3emc_lib.sh" script by modifying the relevant build configuration setup file in the "config-setup/" subdirectory.</p>
<p>Or, if you are going to be testing library builds multiple times, you can create your own configuration setup file.</p>
<h2>B. The more flexible way</h2>
<h3>1. Configuration</h3>
<p>If you need more flexibility in the library build you can specify the necessary information directly to the configure script that generates the makefiles. For example, on WCOSS: </p><pre class="fragment">$ module load sigio
# module load nemsio
$ ./configure --prefix=${PWD} \
            --enable-promote=4|8|d \
            FC="ifort" \
            FCFLAGS="-O2 -g -traceback -fixed"
</pre><p>The &ndash;prefix switch sets the installation directory and defaults to /usr/local so make sure you set it to a directory in which you have write access.</p>
<p>The &ndash;enable-promote switch allows you to specify the type of precision build be it single (4), double (8), or mixed (d) precision. To build the mixed precision library you would use: </p><pre class="fragment">--enable-promote=d
</pre><p>Not specifying this switch is equivalent to "--enable-promote=4".</p>
<p>The definition of the "FC" enviroment variable is not strictly necessary as it defaults to "ifort" on linux systems if available (followed by "gfortran" and "pgf95" if not), and to "xlf2003" on AIX systems.</p>
<p>You can also specify the sigio and nemsio library information on the command line if you need that flexibility. For example: </p><pre class="fragment">$ ./configure --prefix=${PWD} \
            FC="ifort" \
            FCFLAGS="-O2 -g -traceback -fixed" \
            SIGIO_INC4="-I/path/to/incmod" \
            SIGIO_LIB4="/path/to/libsigio_to-use.a" \
            NEMSIO_INC="-I/path/to/incmod" \
            NEMSIO_LIB="/path/to/libnemsio_to-use.a"
</pre><h3>2. Building the library</h3>
<p>To start the library build for a particular configuration, simply type </p><pre class="fragment">$ make
</pre><p>If you are building multiple precision versions of the library by hand (i.e. not using the "make_w3emc_lib.sh" script, see Section A) then make sure to clean out all the previous build's products first by invoking hte clean target first, i.e.: </p><pre class="fragment">$ make clean; make
</pre><h3>3. Testing the library</h3>
<p>We don't have any package-level tests for w3emc yet. Sorry! They're coming...</p>
<h3>4. Installing the library</h3>
<p>Installation of the library <em>always</em> occurs into its own directory within the directory specified by the &ndash;prefix switch.</p>
<h4>NCO Install</h4>
<p>To install the library conforming to the NCO organisation and naming conventions, type: </p><pre class="fragment">$ make nco_install
</pre><p>For a library version (say, v2.1.0) and the default precision (4), this will create a directory called "w3emc". That directory is organised in the so-called vertical structure on WCOSS in /nwprod/lib, as shown below: </p><pre class="fragment">w3emc/
    |
    `--v2.1.0/
        |
        |--libw3emc_v2.1.0_4.a
        |
        `--incmod/
            |
            `--w3emc_v2.1.0_4
</pre><p>If you subsequently build and "nco_install" the other w3emc precision libraries ("8" and "d"), the "w3emc" directory structure will look like: </p><pre class="fragment">w3emc/
    |
    `--v2.1.0/
        |
        |--libw3emc_v2.1.0_4.a
        |--libw3emc_v2.1.0_8.a
        |--libw3emc_v2.1.0_d.a
        |
        `--incmod/
            |
            |--w3emc_v2.1.0_4
            |--w3emc_v2.1.0_8
            `--w3emc_v2.1.0_d
</pre><p>The version subdirectory (v2.1.0) can then be moved into the official /nwprod/lib/w3emc location as needed.</p>
<p>NOTE: The "make_w3emc_lib.sh" script (see Section A) does all of this building and installing of the multiple libraries for you.</p>
<h4>GNU Install</h4>
<p>To perform a GNU-type install, type: </p><pre class="fragment">$ make install
</pre><p>For a library version (say, v2.1.0) and the default precision (4), this will create a directory called "w3emc_v2.1.0_4". That directory structure is shown below: </p><pre class="fragment">w3emc_v2.1.0_4/
    |
    |--include/
    |
    `--lib/
         |
         `--libw3emc.a
</pre><p>Note that the only versioned item in this type of install is the name of the installation directory itself.</p>
<h4>Uninstalling the library</h4>
<p>To uninstall the library (assuming you haven't moved the installation directory contents somewhere else) you can type: </p><pre class="fragment">$ make nco_uninstall
</pre><p>to roll-back an NCO-type install, or: </p><pre class="fragment">$ make uninstall
</pre><p>to roll back a Gnu-type install.</p>
<p>These target will delete the created installation directory.</p>
<h3>5. Cleaning up</h3>
<p>Two targets are provided for cleaning up after the build. To remove all the build products type </p><pre class="fragment">$ make clean
</pre><p>To also remove all the configuration products (i.e. the makefiles) type </p><pre class="fragment">$ make distclean
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Jun 10 2020 12:31:55 for NCEPLIBS-w3emc by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
