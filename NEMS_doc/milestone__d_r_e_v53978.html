<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>NEMS: DREV53978: WAM-IPE 0.1 Side by Side Component Run and Mediator Validation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="make-images-fit.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NEMS
   &#160;<span id="projectnumber">master@eee10ef0fe</span>
   </div>
   <div id="projectbrief">This is a living document and may be updated at any time.</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('milestone__d_r_e_v53978.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">DREV53978: WAM-IPE 0.1 Side by Side Component Run and Mediator Validation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section date"><dt>Date</dt><dd>04/2015</dd></dl>
<h2>Repository URL </h2>
<ul>
<li><a href="https://svnemc.ncep.noaa.gov/projects/ipe/WAM-IPE">https://svnemc.ncep.noaa.gov/projects/ipe/WAM-IPE</a></li>
</ul>
<h2>Description </h2>
<p>In this milestone the <a href="https://esgf.esrl.noaa.gov/projects/wam_ipe/WAM">Whole Atmosphere Model (WAM)</a>/ <a href="http://www.emc.ncep.noaa.gov/index.php?branch=GFS">Global Spectral Model(GSM)</a>, the <a href="https://esgf.esrl.noaa.gov/projects/wam_ipe/IPE">Ionsphere-Plasmasphere Electrodynamics (IPE)</a> model, and the space weather mediator ran side by side without exchanging fields using a NUOPC driver. The milestone was intended as a proof of concept. There were two main goals. The first was to demonstrate that WAM/GSM, IPE, and the mediator can run within a NUOPC coupled system. The second was to demonstrate that a mediator could be built to regrid data between the WAM and IPE grids accurately enough to make the target fully coupled system feasible. This was a technical (non-scientific) milestone.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>add WAM-IPE app docs to repo</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>add grids to repo</dd></dl>
<p>In this milestone both model components ran for 2 days starting at 12/1/2009. The WAM/GSM component ran on the reduced Gaussian <a class="el" href="g_r_i_d_gsm.html">GSM grid</a>. (WAM is a different configuration of the GSM model with a different grid. In this milestone we used the GSM configuration.) The IPE component ran on an 80 x 170 flux tube grid (<a class="el" href="g_r_i_d__i_p_e.html">IPE grid</a>) that extended up to approximately 360,000 km.</p>
<p>The space weather mediator ran independently of the two other components, but simulated a regridding between them. To do this it read in a grid and data from a WAM file. The WAM grid used for the regridding was a global 3D reduced Gaussian grid (<a class="el" href="g_r_i_d_wam.html">WAM grid</a>). The horizontal resolution was T62 and in the vertical there were 150 levels in pressure. Because the relationship between pressure and height varies during a run, the actual heights of the levels of the WAM grid vary during a run. The maximum height of the WAM grid was approximately 800 km. It also read in an IPE grid from a file. The IPE grid was an 80 x 170 flux tube grid (<a class="el" href="g_r_i_d__i_p_e.html">IPE grid</a>) that extended up to approximately 360,000 km. Because of the difference in heights, the WAM grid only overlaps with the bottom of the IPE grid. Once the grids are read in, the mediator then regrids the data from the WAM grid to the IPE grid. The regridding procedure used in the space weather mediator is more complex than a simple one step regridding. As described above, the WAM grid's height varies with pressure, so the vertical relationship between the WAM and IPE grids varies each time-step. To avoid the expense of recomputing the regridding matrix every time-step, quick 1D interpolation in used in the vertical to interpolate between the varying WAM grid and a fixed height intermediate grid. Full 3D interpolation is then used to interpolate between the intermediate grid and the IPE grid. Because the intermediate grid doesn't vary during a run, the full 3D regridding matrix can be computed between it and the IPE grid once at the beginning of the run. Using this method allows the regridding to be done efficiently during each time-step of the run despite the varying WAM grid.</p>
<h2>Build &amp; Run </h2>
<p>Instructions on how to build and run specific code revisions (e.g. this milestone revision) and the supported compsets are provided on the <a href="https://esgf.esrl.noaa.gov/projects/wam_ipe/build_run">WAM-IPE Build &amp; Run</a> page.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>migrate WAM-IPE Build &amp; Run page to repo</dd></dl>
<h2>Validation </h2>
<p>The validation of this milestone consists of two parts: components running within the coupled system, and mediator accuracy. The sections below describe the specific tests and results for each of these parts for the test run.</p>
<p>The test was run on the zeus system at the Environmental Modeling Center.</p>
<h2>Components Running Within System </h2>
<p>Both the WAM/GSM model component and the IPE model component ran to completion as part of the coupled system. As this was a proof of concept milestone without scientific output this was deemed a sufficient result to consider this part of the test a success.</p>
<h2>Mediator Accuracy </h2>
<p>There were two parts to the mediator accuracy check. The first of these was the use of an analytic field to calculate the mean relative error in the regridding. The second was the regridding of actual model data, and then visual inspection of the resulting field to ensure that it looks reasonable.</p>
<p>To verify the accuracy of the regridding in the space weather mediator a slighty different version of the code was used. Instead of reading data in from a file, this version set the data field's values using a function who's output value varied with location. The equation used was:</p>
<ul>
<li>F=cos(lat)2 *cos(2*lon) + 0.01*height + 1.0</li>
</ul>
<p>Using an equation allows the exact values to be computed for the destination field. Having the exact values allows the error to be computed for the regridding. Using this equation the mean relative error of the regridding using the space weather mediator was computed to be 9.1E-05. This was deemed sufficiently accurate to transfer data for the WAM-IPE coupling.</p>
<p>In addition to analytically validating the transfer of a field, a visual verification was performed on the regridding of an actual data field (temperature) from WAM. The following two images are from that verification. The top image is of the field at a height of 104 km in WAM. The bottom image is of the same field regridded to the level at a height of 100 km in the IPE grid. Each image is a plot of the field with the color indicating the field's values. The IPE plot (bottom) is a plot of the points of the IPE grid with the color of each point indicating the value. This type of plot was used to show the IPE grid as well as the values. Because the fields are at a slightly different height and because regridding isn't exact, there is the appearance of some difference in the field between the two plots. However, after examining the images, the conclusion was that the transfer happened correctly.</p>
<div class="image">
<img src="DREV53978-wamTemp104.png" alt="DREV53978-wamTemp104.png"/>
</div>
 <div class="image">
<img src="DREV53978-IPEtemp100km.png" alt="DREV53978-IPEtemp100km.png"/>
</div>
 </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
