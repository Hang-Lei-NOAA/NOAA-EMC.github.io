<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>NEMS: DREV76675: WAM-IPE 0.3 Send Data Fields from WAM to IPE</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="make-images-fit.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NEMS
   &#160;<span id="projectnumber">master@7bd61225cb</span>
   </div>
   <div id="projectbrief">This is a living document and may be updated at any time.</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('milestone__d_r_e_v76675.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">DREV76675: WAM-IPE 0.3 Send Data Fields from WAM to IPE </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section date"><dt>Date</dt><dd>05/31/2016</dd></dl>
<h2>Repository URL </h2>
<ul>
<li><a href="https://svnemc.ncep.noaa.gov/projects/ipe/WAM-IPE">https://svnemc.ncep.noaa.gov/projects/ipe/WAM-IPE</a></li>
</ul>
<h2>Description </h2>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000016">Todo:</a></b></dt><dd>link to WAM and IPE grid pages</dd></dl>
<p>This milestone is an internal release of a NEMS application with two active components. The active components are the <a href="https://esgf.esrl.noaa.gov/projects/wam_ipe/IPE">Ionosphere Plasmasphere Electrodynamics (IPE) model</a> and the <a href="https://esgf.esrl.noaa.gov/projects/wam_ipe/WAM">Whole Atmosphere Model (WAM)</a> All field exchanges in the system occur through the <a class="el" href="sw_mediator.html">space weather mediator</a>. This is a technical (non-scientific) milestone to ensure that field data is passed correctly from WAM through the mediator and then to IPE. In this revision WAM runs on a global 3D reduced Gaussian grid (<a class="el" href="_g_r_i_d_wam.html">WAM grid</a>). The horizontal resolution is T62. The vertical component of this grid is 150 levels in pressure and has to be converted to height in order to couple with IPE. Because the relationship between pressure and height varies during a run, the actual heights of the levels of the WAM grid varies during a run. The maximum height of the WAM grid is approximately 800 km. In this revision IPE runs on an 80 x 170 flux tube grid (<a class="el" href="_g_r_i_d__i_p_e.html">IPE grid</a>) that extends up to approximately 360,000 km. Because of the difference in heights, the WAM grid only overlaps with the bottom of the IPE grid. The amount of the overlap depends on the current height of the WAM grid.</p>
<p>NUOPC "caps", which are essentially wrappers for the coupling interface, are provided for all model components allowing these components to work in NEMS and other NUOPC-compliant systems. For example, the "IPE cap" allows the IPE model to work as a part of the NEMS system.</p>
<p>In this release only a subset of possible fields are exchanged between WAM and IPE. The <a href="https://docs.google.com/a/noaa.gov/spreadsheets/d/1eA9134T3NSvxPKLsZ-Ryth7_fsAU5FjmgAseApov9eY/pubhtml">coupling fields spreadsheet</a> indicates in detail the status of the different coupled fields.</p>
<ul>
<li>The WAM output fields are extracted each time-step during the dynamics calculation part of the model code. The extraction and calculation necessary to generate the fields required by IPE are done by the subroutine get_w_z(). For efficiency's sake this is only done when WAM is running coupled to IPE. That this is occurring is indicated by setting the wam_ipe_coupling namelist variable to true. The fields are stored in the get_variables_for_WAM_IPE_coupling module. From there they are extracted by the WAM cap and passed out to the mediator.</li>
<li>The IPE input fields advertised only represent a subset of the full fields used by IPE. The reason for this is that the WAM and IPE grids only overlap at the bottom of the IPE grid. Transferring the entire IPE grid to the mediator would be inefficient, so only the part that potentially overlaps with WAM is transferred and used for regridding. In the IPE cap the fields received from the mediator are copied into a variable (wamfield) which has the full index space of the IPE fields. This transfer is complex because both representations of the data are collapsed to 1D for efficiency's sake. Once in the wamfield variable the data is extrapolated to fill the empty region. If acting as part of a coupled system, IPE uses the data from wamfield as part of it's computations. In this technical milestone, we will examine the data in wamfield to verify that it was transferred correctly from WAM.</li>
</ul>
<h2>Build &amp; Run </h2>
<p>Instructions on how to build and run specific code revisions (e.g. this milestone revision) and the supported compsets are provided on the WAM-IPE Build &amp; Run page. Run Sequence</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000017">Todo:</a></b></dt><dd>reference the WAM-IPE Build &amp; Run page.</dd></dl>
<p>The NEMS run-time configuration for the WAM-IPE system is provided below. For details on the run sequence in general please refer to the <a class="el" href="architecture.html">Technical Architecture page</a>, and <a class="el" href="configuring.html">Run Configuration</a> page. </p><pre class="fragment">runSeq::
 @21600.0
   ATM -&gt; MED :remapMethod=redist
   MED
   MED -&gt; IPM :remapMethod=redist
   ATM
   IPM
 @
::
</pre><h2>Validation </h2>
<p>The validation procedure for this milestone is to compare the coupling fields in WAM to the fields after they've been transferred to IPE. This comparison is used to determine if the fields are being communicated correctly between the two models. Because the fields are being regridded between the two models the transfer isn't expected to be exact, and so a visual comparison was used to check if the fields are reasonably similar.</p>
<p>The pairs of images in each of the following sections are from the visual check of the correctness of the transfer of the fields. Each section contains a pair of images for a different field.The top image is of the field at an average height of 94.11 km in WAM. The bottom image is of the same field at a height of 94 km in IPE after being transferred from WAM. Each image is a plot of the points making up the field with the color indicating the field's values. This type of plot was used to show the difference in the grids as well as the values. Because the fields are at a slightly different height and because regridding isn't exact, there is the appearance of some difference in the field between the two plots. However, after examining the images, the conclusion was that the transfer happened correctly in each case.</p>
<p>During this test both components run for a one hour simulation, coupling every three minutes.</p>
<p>A test report is available for this validation run: <a class="el" href="_r_e_p_o_r_t-20160531-_w_a_m-_i_p_e-initial-1way.html">Initial One-Way WAM to IPE Connection Test Report</a></p>
<h3>Field Temp_Neutral</h3>
<div class="image">
<img src="DREV76675-nt_wam.png" alt="DREV76675-nt_wam.png"/>
</div>
 <div class="image">
<img src="DREV76675-nt_ipe.png" alt="DREV76675-nt_ipe.png"/>
</div>
<h3>Field Northward_Wind_Neutral</h3>
<div class="image">
<img src="DREV76675-nwn_wam.png" alt="DREV76675-nwn_wam.png"/>
</div>
 <div class="image">
<img src="DREV76675-nwn_ipe.png" alt="DREV76675-nwn_ipe.png"/>
</div>
<h3>Field Eastward_Wind_Neutral</h3>
<div class="image">
<img src="DREV76675-ewn_nam.png" alt="DREV76675-ewn_nam.png"/>
</div>
 <div class="image">
<img src="DREV76675-ewn_ipe.png" alt="DREV76675-ewn_ipe.png"/>
</div>
<h3>Field Upward_Wind_Neutral</h3>
<div class="image">
<img src="DREV76675-uwn_wam.png" alt="DREV76675-uwn_wam.png"/>
</div>
 <div class="image">
<img src="DREV76675-uwn_ipe.png" alt="DREV76675-uwn_ipe.png"/>
</div>
<h3>Field O_Density</h3>
<div class="image">
<img src="DREV76675-o_wam.png" alt="DREV76675-o_wam.png"/>
</div>
 <div class="image">
<img src="DREV76675-o_ipe.png" alt="DREV76675-o_ipe.png"/>
</div>
<h3>Field O2_Density</h3>
<div class="image">
<img src="DREV76675-o2_wam.png" alt="DREV76675-o2_wam.png"/>
</div>
 <div class="image">
<img src="DREV76675-o2_ipe.png" alt="DREV76675-o2_ipe.png"/>
</div>
<h3>Field N2_Density</h3>
<div class="image">
<img src="DREV76675-n2_wam.png" alt="DREV76675-n2_wam.png"/>
</div>
 <div class="image">
<img src="DREV76675-n2_ipe.png" alt="DREV76675-n2_ipe.png"/>
</div>
<h2>Limitations and Technical Notes </h2>
<p>This milestone is purely a verification of the transfer of data. The results of this coupling haven't been scientifically validated and so shouldn't be expected to behave in a physically realistic manner. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
