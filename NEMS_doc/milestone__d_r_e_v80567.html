<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>NEMS: DREV80567 (DREV87736) UGCS-Seasonal 0.3</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="make-images-fit.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NEMS
   &#160;<span id="projectnumber">master@fb387d39b5</span>
   </div>
   <div id="projectbrief">This is a living document and may be updated at any time.</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('milestone__d_r_e_v80567.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">DREV80567 (DREV87736) UGCS-Seasonal 0.3 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section date"><dt>Date</dt><dd>Last revised: 2/3/2017</dd></dl>
<h2>Repository URL </h2>
<ul>
<li><a href="https://svnemc.ncep.noaa.gov/projects/nems/apps/UGCS-Seasonal/trunk">https://svnemc.ncep.noaa.gov/projects/nems/apps/UGCS-Seasonal/trunk</a></li>
</ul>
<h2>Important notes about this revision </h2>
<dl class="section warning"><dt>Warning</dt><dd>After the release of this DREV80567 revision, Github made changes to their repository software that resulted in incorrect mappings when Github revisions were used as SVN externals. This resulted in the DREV80567 UGCS-Seasonal application pulling in different and arbitrary revisions of its constituent components, causing the application to crash. A subsequent fix from Github restored the correct mappings. <code>In</code> order to avoid this issue in the future, explicit tags are now being used to pull in Github revisions from SVN. An identical version of the original DREV80567 was defined using tags as DREV87736. Although DREV80567 appears to be working correctly, we recommend that revision DREV87736 be used instead of DREV80567 as it is designed to avoid repository issues in the future.</dd></dl>
<p>Note also that in order to run this milestone on Theia, you must have a ~/.cshrc file in your home directory that contains the line "limit
stacksize unlimited". The ~/.cshrc with this line must exist no matter what shell you are using! Description</p>
<p>UGCS-Seasonal 0.3 (DREV80567/DREV87736) is a three-way configuration of the <a href="http://www.emc.ncep.noaa.gov/index.php?branch=GFS">Global Spectral Model (GSM)</a>, <a href="http://mom-ocean.org/web">Modular Ocean Model 5 (MOM5)</a>, and <a href="http://oceans11.lanl.gov/trac/CICE/">Los Alamos Sea Ice Model (CICE)</a>. GSM runs on a <a class="el" href="_g_r_i_d__reduced__t574.html">T574 grid</a>, and MOM5 and CICE run on a <a class="el" href="_g_r_i_d_mom5_0p5deg_tripole.html">0.5 degree tripolar global grid with 0.25 degree tropics.</a> A full set of fields is transferred among components using the NEMS mediator (<a href="https://docs.google.com/spreadsheets/d/1Tae7NoGbIfti38QxvmzPy7Z4tIWQgY4zSdq5Xcx9MDk/edit?usp=sharing">see exchange field spreadsheet</a>).</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000020">Todo:</a></b></dt><dd>add and link to grid pages</dd></dl>
<p>Relative to <a class="el" href="milestone__d_r_e_v73964.html">UGCS-Seasonal 0.2</a>. this revision added the capability to peform basic restarts. This required modifications to the NEMS mediator and CICE so that restarts could be written at more flexible time intervals. This revision also included a command-line version of the NEMS AppBuilder. The unphysical wind stresses in the northern ocean present in UGCS-Seasonal 0.2 were resolved with a sign fix in the ocean/ice stress that the ocean sees. Ice initial conditions were updated for the runs performed, and now include snow on ice. This revision also includes performance optimizations. Both the initialize and run phases of the coupled system were profiled and optimized. The performance at the conclusion of the optimization process was approximately that of a similarly configured version of CFSv2. In addition, a check in the mediator was removed that fills in SST and sea ice temp fields on "unset" (land) points to 271 deg C before doing a merge.</p>
<p>This revision has been run for more than 30 days and exhibits behavior that is Earth-like.</p>
<p>A limitation of this revision is that fluxes are known to be computed inconsistently. The atmosphere/ocean flux over open water is computed in GSM and merged with the atmosphere/land flux. The atmosphere/ocean flux computed in the mediator uses a different algorithm, based on CESM code. The ice/ocean flux and ice fraction are computed in CICE.</p>
<p>A short-term fix was requested by EMC scientists and implemented, but it is not in this DREV80567 revision. It is available as revision 84966 on a flux_update branch. In this fix, the atmosphere/ocean flux that the ocean model uses over open water is the GSM atmosphere/ocean flux (using the mask sent from GSM to exclude the atmosphere/land flux). For points that have some fractional ice, a merge of the mediator atmosphere/ocean flux plus the ice/ocean flux from CICE is used. The atmosphere/ocean flux that the atmosphere model uses is basically the same as what the ocean uses. Over open water, GSM uses the atmosphere/ocean flux it computes internally. Where there is some fractional ice, the GSM uses the merged atmosphere/ocean/ice flux provided by the mediator. The issue with the fix is that although the components now see the same fluxes, there is a discontinuity at the points where open ocean meets fractional ice, since the atmosphere/ocean fluxes for open ocean and ice fraction are still computed using different algorithms. Run Sequences</p>
<p>UGCS-Seasonal includes two run sequences, a cold start sequence and a time integration sequence.</p>
<p>Cold start sequence: The first cold start sequence initializes components using a miinimal set of files ingested by GSM. The cold start sequence only needs to run for a half hour. However, it runs for an hour because there is a limitation on running less than an hour in EMC scripts. </p><pre class="fragment">runSeq::
  @1800.0
    @600.0
      MED MedPhase_prep_atm
      MED -&gt; ATM :remapMethod=redist
      ATM
      ATM -&gt; MED :remapMethod=redist
      MED MedPhase_prep_ice
      MED -&gt; ICE :remapMethod=redist
      ICE
      ICE -&gt; MED :remapMethod=redist
      MED MedPhase_atm_ocn_flux
      MED MedPhase_accum_fast
    @
    MED MedPhase_prep_ocn
    MED -&gt; OCN :remapMethod=redist
    OCN
    OCN -&gt; MED :remapMethod=redist
  @
::
</pre><p>Time integration sequence: The second run sequence, shown below, is for the time integration loop. It is initialized by restart files generated by the cold start sequence. As in UGCS&ndash;Seasonal 0.1, there is a fast and a slow loop, at 10 minutes and 30 minutes, respectively. </p><pre class="fragment">runSeq::
  @1800.0
    MED MedPhase_prep_ocn
    MED -&gt; OCN :remapMethod=redist
    OCN
    @600.0
      MED MedPhase_prep_ice
      MED MedPhase_prep_atm
      MED -&gt; ATM :remapMethod=redist
      MED -&gt; ICE :remapMethod=redist
      ATM
      ICE
      ATM -&gt; MED :remapMethod=redist
      ICE -&gt; MED :remapMethod=redist
      MED MedPhase_atm_ocn_flux
      MED MedPhase_accum_fast
    @
    OCN -&gt; MED :remapMethod=redist
    MED MedPhase_write_restart
  @
::
</pre><h2>Validation </h2>
<p>The following slides show resolution of the unphysical northern ocean wind stresses, before (left) and after (right) the sign change. The results are shown after a 5-day run. (From A. Craig.)</p>
<div class="image">
<img src="DREV80567-ocnspeed_120h.gif" alt="DREV80567-ocnspeed_120h.gif"/>
</div>
 <div class="image">
<img src="DREV80567-ocnspeed_new_120h.gif" alt="DREV80567-ocnspeed_new_120h.gif"/>
</div>
<p>These results are from a development system and do not represent a NOAA prediction or product.</p>
<h2>Download, Build, Run, and Restart </h2>
<h3>Download and Build</h3>
<p>Instructions on how to download and build a NEMS application are discussed in the <a class="el" href="documentation.html">NEMS User's Guide and Reference</a>. Running UGCS-Seasonal with a cold start requires additional instructions, below.</p>
<p>Please see Important notes about this revision section at the top of this page. Cold Start and Run</p>
<p>Compsets that can be run with this revision are:</p>
<ul>
<li><code>cfsr%20150401_1hr_nemscold_gsmslgT574_cice%0.5_mom5%0.5</code></li>
<li><code>cfsr%20150401_1day_nems_gsmslgT574_cice%0.5_mom5%0.5</code></li>
</ul>
<p>To run compsets, start within the UGCS-Seasonal directory and execute the NEMS CompsetRun tool by typing: </p><pre class="fragment">./NEMS/NEMSCompsetRun -compset &lt;compset name&gt;
</pre><p>If you leave off the -compset argument, CompsetRun will read the compset list from a local file.</p>
<p>To initialize a new case of the UGCS-Seasonal from a cold start, run the cold start compset, <code>cfsr%20150401_1hr_nemscold_gsmslgT574_cice%0.5_mom5%0.5</code>, to generate initial mediator restart files. That compset runs the atm/ice/ocean sequentially for 1 hour. It will generate some initial mediator restart files consisting of initial values for coupling fields consistent with the current atmosphere, ocean, and sea ice conditions. You then use those initial mediator files to startup a standard run with the same model initial conditions and initial model date as the cold start run. To do this, run the coldstart compset using CompsetRun as specified above with the compset, <code>cfsr%20150401_1day_nems_gsmslgT574_cice%0.5_mom5%0.5</code>.</p>
<p>After running the cold start compset, go into NEMS/NEMSCompsetRun and modify "setup_med_nems" to pre-stage the cold start mediator restart files instead of whatever files are set by default. This is done in a section that looks like: </p><pre class="fragment">cp -f ${DATADIR}/MED_NEMS/${nemsgrid}${nemsgridinp}/* ${RUNDIR}
#  cp -f /scratch3/NCEPDEV/stmp1/Anthony.Craig/UGCS-Seasonal.r72808/20150401short_nemscold_gsm_cice_mom5/mediator*restart* ${RUNDIR}
</pre><p>(You will need to adjust the directory, compset, and revision for this milestone.)</p>
<p>Comment out the first line and uncomment the second line. In the second line, set the path to the cold start run directory where the cold start case just ran. This will copy the mediator restart files from your cold start run directory into the new run directory.</p>
<p>Once the cold start is done and the NEMSCompsetRun is modified, run a standard compset like <code>cfsr%20150401_1day_nems_gsmslgT574_cice%0.5_mom5%0.5</code> to advance the model from the initial conditions. The system will start with the same atmosphere, ocean, and ice initial conditions as the cold start run plus the new mediator restart files, and the model will run concurrently. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
