<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>NEMS: DREV70089: Reg-Hydro 0.2</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="make-images-fit.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NEMS
   &#160;<span id="projectnumber">master@eee10ef0fe</span>
   </div>
   <div id="projectbrief">This is a living document and may be updated at any time.</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('milestone__d_r_e_v70089.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">DREV70089: Reg-Hydro 0.2 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section date"><dt>Date</dt><dd>02/22/2016</dd></dl>
<h2>Repository URL </h2>
<ul>
<li><a href="https://svnemc.ncep.noaa.gov/projects/nems/apps/Regional/trunk">https://svnemc.ncep.noaa.gov/projects/nems/apps/Regional/trunk</a></li>
</ul>
<h2>Description </h2>
<p>The Regional 0.2 (revision 70089) milestone is an internal release of a NEMS modeling application with five active components: GSM atmosphere, CICE sea ice, MOM ocean, LIS/Noah land, and WRF-Hydro. GSM-CICE-MOM run as a fully coupled three-way system (essentially the <a class="el" href="milestone__d_r_e_v58214.html">UGCS-Seasonal configuration</a>). LIS/Noah and WRF-Hydro receive fields from GSM and these are hooked up to model internals. LIS/Noah and WRF-Hydro send fields to the GSM and they are received at the interface, but these fields are not connected to GSM internals. All field exchanges in the system occur through the central NEMS mediator. This is a technical (non-scientific) milestone to ensure that all five active components are able to run inside NEMS and to ensure that field data is correctly regridded through the Mediator among GSM, LIS/Noah and WRF-Hydro. For this release, the outputs from LIS/Noah and WRF-Hydro are not used by GSM, which uses its own internal land surface model. GSM and LIS/Noah run on a global ~1 degree T126 grid ( <a class="el" href="_g_r_i_d_gsm.html">GSM Grid</a>, <a class="el" href="_g_r_i_d__l_i_s__t126.html">LIS T126 Grid</a>). MOM and CICE run on a global ~1 degree tripolar grid (<a class="el" href="_g_r_i_d_mom5_1deg_tripole.html">MOM-CICE Grids</a>). WRF-Hydro runs on a small regional domain over the Colorado Front Range at 1km resolution (Front Range Grid). The global components (GSM-CICE-MOM) are currently used in the system as stand-ins for the regional atmosphere-ice-ocean components. The regional atmosphere NMMB was not used because it was not available as a NUOPC component when development began on this milestone.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>reference grids</dd></dl>
<p>NUOPC "caps", which are essentially wrappers for the coupling interface, are provided for all model components, including WRF-Hydro and LIS, allowing these components to work in NEMS and other NUOPC-compliant systems. The version of each component used is:</p>
<ul>
<li><a href="https://www.earthsystemcog.org/projects/esps/atmospheric_models#GSM">GSM - R69235</a></li>
<li><a href="https://www.earthsystemcog.org/projects/esps/ocean_models#MOM5">MOM 5.0</a></li>
<li><a href="https://www.earthsystemcog.org/projects/esps/ice_models#CICE5_0_2">CICE 5.0.2</a></li>
<li><a href="https://www.earthsystemcog.org/projects/esps/land_surface_models#LIS7_1_NOAH3_3">LIS 7.1r / Noah 3.3</a></li>
<li><a href="https://www.earthsystemcog.org/projects/esps/hydrological_models#WRFHYDRO3">WRF-Hydro 3.0</a></li>
</ul>
<p>In this release only a subset of possible fields are exchanged between LIS/Noah, WRFHydro and the active atmosphere. Because complete forcings are not provided as input to these components, it should not be expected that the land surface model nor hydrological models produce physically realistic output in the current configuration. The <a href="https://drive.google.com/open?id=1plqAjA3u1cXueT9DHk3erur6kI5glxkXkwA5cxsoM5M">Regional v0.2 coupling field spreadsheet</a> indicates in detail which fields are advertised and hooked up internally for each component as well as which fields are exchanged with the Mediator.</p>
<ul>
<li>LIS fields advertised in its NUOPC cap are hooked up to the internal LIS data structures, LIS_FORC_State (exports) and LISWRF_export (imports), which are in turn connected by LIS to an internal land surface model. At this time, the LISWRF_export data structure only supports the Noah 3.3 land surface model. The list of LIS imports that are advertised and hooked up to internal data structures can be seen in columns AN and AO, respectively, of the field spreadsheet (linked above). The lists of LIS exports that are advertised and hooked up are in columns AQ and AR.</li>
<li>WRF-Hydro fields advertised in its NUOPC cap are hooked up directly to the internal rt_domain data structure. Currently, WRF-Hydro does not use meterological forcings directly to compute hydrological state, so GSM fields transferred from the Mediator to WRF-Hydro are only intended to test the integrity of the field transfer and regridding. The list of WRF-Hydro imports that are advertised and hooked up to internal data structures can be seen in columns AT and AU, respectively, of the field spreadsheet. The list of WRF-Hydro exports that are advertised and hooked up are in columns AW and AX.</li>
<li>Because GSM is running with an embedded land surface model, the GSM NUOPC cap does not advertise import fields for land surface or hydrological inputs. In other words, for this technical milestone, the land surface model is duplicated: an internal land surface model used by GSM and an external land surface model, driven as a separate component. Therefore, LIS/Noah and WRF-Hydro fields exported from the Mediator to GSM are only intended to test the integrity of the field transfer and regridding and are not used to affect the state of GSM.</li>
<li>For this release, not all fields advertised in the LIS and WRF-Hydro NUOPC caps are also advertised in the Mediator. Instead, a small number of fields have been activated to test the integrity of the field transfer and regridding. Land and hydro fields imported into the Mediator are indicated by an "l" and "h," respectively, in column I of the field spreadsheet. Likewise, land and hydro fields exported from the Mediator are indicated in column M. The set of field pairs for which regridding was validated appears in the Mediator Regridding section below.</li>
</ul>
<h2>Build &amp; Run </h2>
<p>Instructions on how to build and run specific code revisions (e.g. this milestone revision) and the supported compsets are provided on the <a href="https://esgf.esrl.noaa.gov/projects/couplednems/regional">Regional Application Build &amp; Run</a> page.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd>move regional app page to nems repo</dd></dl>
<h2>Specifying Runtime Configuration </h2>
<p>The LIS and WRFHYDRO runtime configuration files are specified as parameters when calling the component setup function in the compset file. Default locations for configuration files are provided for each available compset on both Theia and Yellowstone.</p>
<p>setup_lis "[Full path to lis.config file]"</p>
<p>setup_wrfhydro "[Full path to hydro.namelist file]" "[Directory containing parameter files]" "[Full path to namelist.hrldas file]" Cleaning &amp; Rebuilding</p>
<p>The NEMSAppBuilder will prompt, for each component, whether to clean and rebuild or use an existing library, if one was previously built. External Repositories</p>
<p>The Regional application is made up of some external components with master repositories outside of EMC, including LIS and WRF-Hydro. A basic strategy with rsync is being used to ensure that changes to external components are committed to the EMC Subversion repository and the external component's master repository. Technical details are available here:</p>
<ul>
<li><a href="https://www.earthsystemcog.org/projects/earthsystembridge/lis_upstream_sync">https://www.earthsystemcog.org/projects/earthsystembridge/lis_upstream_sync</a></li>
</ul>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000008">Todo:</a></b></dt><dd>The lis_upstream_sync page no longer exists. Find substitute or remove.</dd></dl>
<h2>Code Repositories </h2>
<p>WRF-Hydro source code is available in the NEMS SVN repository. It is maintained there as a clone of the official WRF-Hydro repository at NCAR (privately hosted on GitHub). Specifically, the version used for the v0.2 Regional app is:</p>
<ul>
<li><a href="https://svnemc.ncep.noaa.gov/projects/nems/external_comps/WRFHYDRO/trunk/NDHM">https://svnemc.ncep.noaa.gov/projects/nems/external_comps/WRFHYDRO/trunk/NDHM</a> (revision 70071)</li>
</ul>
<p>LIS source code is also available in the NEMS SVN repository. It is maintained as a clone of the official LIS repository hosted at NASA-NCCS (private access).</p>
<ul>
<li><a href="https://svnemc.ncep.noaa.gov/projects/nems/external_comps/LIS/branches/nuopc">https://svnemc.ncep.noaa.gov/projects/nems/external_comps/LIS/branches/nuopc</a> (revision 70071)</li>
</ul>
<h2>Run Sequence </h2>
<p>The NEMS run-time configuration for the default Regional configuration is provided below. Note that LND and HYD are run on disjoint processor sets, and will run concurrently during each step of the inner time loop. For details on the run sequence in general please refer to the <a class="el" href="configuring.html">Configuring</a> and <a class="el" href="architecture.html">Architecture</a> pages. </p><pre class="fragment">runSeq::
  @7200.0
    OCN -&gt; MED :remapMethod=redist
    MED MedPhase_slow
    MED -&gt; OCN :remapMethod=redist
    OCN
    @3600.0
      MED MedPhase_fast_before
      MED -&gt; ATM :remapMethod=redist
      MED -&gt; ICE :remapMethod=redist
      MED -&gt; LND :remapMethod=redist
      MED -&gt; HYD :remapMethod=redist
      ATM
      LND
      HYD
      ICE
      ATM -&gt; MED :remapMethod=redist
      ICE -&gt; MED :remapMethod=redist
      LND -&gt; MED :remapMethod=redist
      HYD -&gt; MED :remapMethod=redist
      MED MedPhase_fast_after
    @
  @
::
</pre><h2>Validation </h2>
<p>The validation procedure for this release is to verify correct redistribution of data from the LIS and WRF-Hydro component caps to the Mediator and to verify correct regridding of fields among the ATM, LND, and HYD components. All components run for a four hour simulation using a set of initial conditions from 2009. Details of the validation appear in the sections below.</p>
<p>A detailed test report is available for the validation run: <a href="https://esgf.esrl.noaa.gov/projects/couplednems/regional_testreports_regional_0_2">NEMS Regional_0_2 Test Report 2016-02-19</a></p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000009">Todo:</a></b></dt><dd>move NEMS Regional_0_2 Test Report 2016-02-19 to repo</dd></dl>
<h3>Connector Redistribution</h3>
<p>Redistribution of data between each component and the mediator has been bit-for-bit validated using ncdiff to compute the per cell difference between files and ncwa to find the maximum and minimum difference values. All connections reported zeros for the maximum and minimum differences.</p>
<table class="doxtable">
<tr>
<th align="left">Connection </th><th align="left">Field </th><th align="left">Source File Prefix </th><th align="left">Destination File Prefix </th><th align="left">Min Diff </th><th align="left">Max Diff </th><th align="left">Status  </th></tr>
<tr>
<td align="left">GSM-&gt;MED </td><td align="left">inst_down_lw_flx </td><td align="left">field_atm_export_ </td><td align="left">field_med_from_atm_ </td><td align="left">0 </td><td align="left">0 </td><td align="left">OK </td></tr>
<tr>
<td align="left">GSM-&gt;MED </td><td align="left">mean_prec_rate </td><td align="left">field_atm_export_ </td><td align="left">field_med_from_atm_ </td><td align="left">0 </td><td align="left">0 </td><td align="left">OK </td></tr>
<tr>
<td align="left">LIS-&gt;MED </td><td align="left">mean_laten_heat_flx_atm_into_lnd </td><td align="left">field_lis_export_ </td><td align="left">field_med_from_lnd_ </td><td align="left">0 </td><td align="left">0 </td><td align="left">OK </td></tr>
<tr>
<td align="left">LIS-&gt;MED </td><td align="left">temperature_of_soil_layer_1 </td><td align="left">field_lis_export_ </td><td align="left">field_med_from_lnd_ </td><td align="left">0 </td><td align="left">0 </td><td align="left">OK </td></tr>
<tr>
<td align="left">WRFHYDRO-&gt;MED </td><td align="left">liquid_water_content_of_soil_layer_1 </td><td align="left">field_wrfhydro_export_ </td><td align="left">field_med_from_hyd_ </td><td align="left">0 </td><td align="left">0 </td><td align="left">OK </td></tr>
<tr>
<td align="left">MED-&gt;WRFHYDRO </td><td align="left">temperature_of_soil_layer_1 </td><td align="left">field_med_to_hyd_ </td><td align="left">field_wrfhydro_import_ </td><td align="left">0 </td><td align="left">0 </td><td align="left">OK </td></tr>
<tr>
<td align="left">MED-&gt;LIS </td><td align="left">liquid_water_content_of_soil_layer_1 </td><td align="left">field_med_to_lnd_ </td><td align="left">field_lis_import_ </td><td align="left">0 </td><td align="left">0 </td><td align="left">OK </td></tr>
<tr>
<td align="left">MED-&gt;LIS </td><td align="left">mean_prec_rate </td><td align="left">field_med_to_lnd_ </td><td align="left">field_lis_import_ </td><td align="left">0 </td><td align="left">0 </td><td align="left">OK </td></tr>
<tr>
<td align="left">MED-&gt;WRFHYDRO </td><td align="left">inst_down_lw_flx </td><td align="left">field_med_to_hyd_ </td><td align="left">field_wrfhydro_import </td><td align="left">0 </td><td align="left">0 </td><td align="left">OK </td></tr>
<tr>
<td align="left">MED-&gt;GSM </td><td align="left">(GSM does not advertise import<br />
 fields from LIS or WRFHYDRO) </td><td align="left">&#160; </td><td align="left">&#160; </td><td align="left">N/A </td><td align="left">N/A </td><td align="left">Not Tested. </td></tr>
</table>
<h3>Plot Generation</h3>
<p>Regridded field data is visualized on lat-lot plots using the following Ferret command. </p><pre class="fragment">shade/k=&lt;TIMESTEP&gt;/vlimits=&lt;LATITUDE_SOUTH&gt;:&lt;LATITUDE_NORTH&gt;/hlimits=&lt;LONGITUDE_WEST&gt;:&lt;LONGITUDE_EAST&gt;/levels=(&lt;SCALE_LOWEST&gt;,&lt;SCALE_HIGHEST&gt;,&lt;SCALE_STEP&gt;) ignore0(&lt;FIELD&gt;[d=&lt;DATASET&gt;]), &lt;LONGITUDE_FIELD&gt;[d=&lt;DATASET&gt;], &lt;LATITUDE_FIELD&gt;[d=&lt;DATASET&gt;]
</pre><p>GSM data must be regridded to LIS even though both components run on the T126 grid. GSM populates the T126 grid cells from northernmost latitude to southernmost latitude therefore Fortran cell index (1,1) is the North-East cell. LIS populates the T126 grid cells from southernmost latitude to northernmost latitude therefore Fortran cell index (1,1) is the South-East cell.</p>
<h4>GSM: mean_prec_rate plotted on cell indices versus plotted on cell coordinates</h4>
<div class="image">
<img src="DREV70089-atm_mean_prec_rate.png" alt="DREV70089-atm_mean_prec_rate.png"/>
</div>
<p>LEFT: Mean precipitation rate plotted on Fortran array indices.</p>
<p>RIGHT: Mean precipitation rate plotted on cell center longitude (x) and cell center latitude (y) coordinates.</p>
<h3>Mediator Regridding</h3>
<p>The table below lists the field regridding operations in the Mediator that were verified using visual inspection. Each regridded field is shown below in before and after plots.</p>
<table class="doxtable">
<tr>
<th align="left">Regrid </th><th align="left">Field </th><th align="left">Source Grid </th><th align="left">Destination Grid </th><th align="left">Link </th><th align="left">Status  </th></tr>
<tr>
<td align="left">GSM -&gt; LIS </td><td align="left">mean_prec_rate </td><td align="left">GSM T126 Grid </td><td align="left">LIS T126 Grid </td><td align="left">#GSM_to_LIS </td><td align="left">OK </td></tr>
<tr>
<td align="left">GSM -&gt; WRFHYDRO </td><td align="left">inst_down_lw_flx </td><td align="left">GSM T126 Grid </td><td align="left">Front Range Regional Grid </td><td align="left">#GSM_to_WRFHYDRO </td><td align="left">OK </td></tr>
<tr>
<td align="left">LIS -&gt; GSM </td><td align="left">mean_laten_heat_flx </td><td align="left">LIS T126 Grid </td><td align="left">GSM T126 Grid </td><td align="left">#LIS_to_GSM </td><td align="left">OK </td></tr>
<tr>
<td align="left">LIS -&gt; WRFHYDRO </td><td align="left">temperature_of_soil_layer_1 </td><td align="left">LIS T126 Grid </td><td align="left">Front Range Regional Grid </td><td align="left">#LIS_to_WRFHYDRO </td><td align="left">OK </td></tr>
<tr>
<td align="left">WRFHYDRO -&gt; LIS </td><td align="left">liquid_water_content_of_soil_layer_1 </td><td align="left">Front Range Regional Grid </td><td align="left">LIS T126 Grid </td><td align="left">#WRFHYDRO_to_LIS </td><td align="left">OK </td></tr>
<tr>
<td align="left">WRFHYDRO -&gt; GSM </td><td align="left">liquid_water_content_of_soil_layer_1 </td><td align="left">Front Range Regional Grid </td><td align="left">GSM T126 Grid </td><td align="left">#WRFHYDRO_to_GSM </td><td align="left">OK </td></tr>
</table>
<h3>GSM -&gt; LIS: mean_prec_rate</h3>
<div class="image">
<img src="DREV70089-atm2lnd_regrid_mean_prec_rate.png" alt="DREV70089-atm2lnd_regrid_mean_prec_rate.png"/>
</div>
<p>LEFT: Mean precipitation rate after the NEMS Mediator has imported and redistributed data from GSM.</p>
<p>RIGHT: Mean precipitation rate after the NEMS Mediator has regridded data to the LIS grid. </p><hr/>
<h4>GSM -&gt; WRFHYDRO: inst_down_lw_flx</h4>
<div class="image">
<img src="DREV70089-atm2hyd_regrid_inst_down_lw_flx.png" alt="DREV70089-atm2hyd_regrid_inst_down_lw_flx.png"/>
</div>
<p>LEFT: Instantaneous downward longwave flux scaled to the WRFHYDRO regional grid after the NEMS Mediator has imported and redistributed data from GSM.</p>
<p>RIGHT: Instantaneous downward longwave flux after the NEMS Mediator has regridded data to the WRFHYDRO grid.</p>
<h4>GSM: Global inst_down_lw_flx</h4>
<div class="image">
<img src="DREV70089-atm_inst_down_lw_flx.png" alt="DREV70089-atm_inst_down_lw_flx.png"/>
</div>
<p>ABOVE: Instantaneous downward longwave flux on the global T126 grid after the NEMS Mediator has imported and redistributed data from GSM. </p><hr/>
<h4>LIS -&gt; GSM: mean_laten_heat_flx</h4>
<div class="image">
<img src="DREV70089-lnd2atm_regrid_mean_laten_heat_flx.png" alt="DREV70089-lnd2atm_regrid_mean_laten_heat_flx.png"/>
</div>
<p>LEFT: Mean latent heat flux after the NEMS Mediator has imported and redistributed data from LIS.</p>
<p>RIGHT: Mean latent heat flux after the NEMS Mediator has regridded data to the GSM grid. </p><hr/>
<h4>LIS -&gt; WRFHYDRO: temperature_of_soil_layer_1</h4>
<div class="image">
<img src="lnd2hyd_temperature_of_soil_layer_1.png" alt="lnd2hyd_temperature_of_soil_layer_1.png"/>
</div>
<p>LEFT: Temperature of the first soil layer scaled to the WRFHYDRO regional grid after the NEMS Mediator has imported and redistributed data from LIS.</p>
<p>RIGHT: Temperature of the first soil layer after the NEMS Mediator has regridded data to the WRFHYDRO grid.</p>
<h4>LIS: Global temperature_of_soil_layer_1</h4>
<div class="image">
<img src="DREV70089-lnd_temperature_of_soil_layer_1.png" alt="DREV70089-lnd_temperature_of_soil_layer_1.png"/>
</div>
<p>ABOVE: Temperature of the first soil layer on the global T126 grid after the NEMS Mediator has imported and redistributed data from LIS. </p><hr/>
<h4>WRFHYDRO -&gt; LIS: liquid_water_content_of_soil_layer_1</h4>
<div class="image">
<img src="DREV70089-hyd2lnd_regrid_liquid_water_content_of_soil_layer_1.png" alt="DREV70089-hyd2lnd_regrid_liquid_water_content_of_soil_layer_1.png"/>
</div>
<p>LEFT: Liquid water content of the first soil layer after the NEMS Mediator has imported and redistributed data from WRFHYDRO.</p>
<p>RIGHT: Liquid water content of the first soil layer scaled to the WRFHYDRO regional grid after the NEMS Mediator has regridded data to the LIS grid.</p>
<h4>LIS: Global liquid_water_content_of_soil_layer_1</h4>
<div class="image">
<img src="DREV70089-lnd_liquid_water_content_of_soil_layer_1.png" alt="DREV70089-lnd_liquid_water_content_of_soil_layer_1.png"/>
</div>
<p>ABOVE: Liquid water content of the first soil layer on the global T126 grid after the NEMS Mediator has regridded data to the LIS grid.</p>
<h4>WRFHYDRO -&gt; GSM: liquid_water_content_of_soil_layer_1</h4>
<div class="image">
<img src="DREV70089-hyd2atm_regrid_liquid_water_content_of_soil_layer_1.png" alt="DREV70089-hyd2atm_regrid_liquid_water_content_of_soil_layer_1.png"/>
</div>
<p>LEFT: Liquid water content of the first soil layer after the NEMS Mediator has imported and redistributed data from WRFHYDRO.</p>
<p>RIGHT: Liquid water content of the first soil layer scaled to the WRFHYDRO regional grid after the NEMS Mediator has regridded data to the GSM grid.</p>
<h4>GSM: Global liquid_water_content_of_soil_layer_1</h4>
<div class="image">
<img src="DREV70089-atm_liquid_water_content_of_soil_layer_1.png" alt="DREV70089-atm_liquid_water_content_of_soil_layer_1.png"/>
</div>
<p>ABOVE: Liquid water content of the first soil layer on the global T126 grid after the NEMS Mediator has regridded data to the GSM grid.</p>
<h2>Limitations and Technical Notes </h2>
<table class="doxtable">
<tr>
<th>Issue</th><th>Description</th><th>Solution </th></tr>
<tr>
<td>LIS Grid </td><td>LIS does not provide all the grid information required for conservative regridding. Cell corner coordinates and cell areas are missing. </td><td>LIS is running on the same grid as GSM, T126. The corner coordinates and areas are copied from ATM to LND within the mediator. Although LIS and GSM share the same grid the latitude coordinates are filled in opposite directions. Therefore when the corner coordinates are copied from ATM to LND the latitude coordinates are inverted. </td></tr>
<tr>
<td>WRF-Hydro Grid </td><td>WRF-Hydro does not provide all the grid information required for conservative regridding. Cell areas are missing. WRF-Hydro uses the ESMF cell area calculation. The ESMF cell area calculation computes cell area in square Earth radians. Square Earth radians are converted to square meters using the Earth's mean radius (m) squared, 6,376,0002. This is the Earth's radius defined in the GSM cap. </td><td>The NEMS_GRID environment variable defines the CICE grid during compile time. Once CICE has been compiled with a specified grid it cannot be changed at runtime. The NEMS_GRID environment variable is set in the regional.AppBuilder file to T126_nx1.  </td></tr>
</table>
<h2>Variable Number of Soil Layers </h2>
<p>LIS provides an abstraction of multiple land surface models, each having varying numbers of soil layers. The LIS abstraction of coupled export fields is only complete for Noah3.3 at this time and only supports 4 soil layers. The LIS NUOPC cap leverages the coupled export fields abstraction and therefore only supports Noah3.3 and 4 soil layers. At this this time the individual soil layers are broken into four 2D fields, which are coupled through NUOPC, therefore eliminating the need for an ungridded field dimension. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
