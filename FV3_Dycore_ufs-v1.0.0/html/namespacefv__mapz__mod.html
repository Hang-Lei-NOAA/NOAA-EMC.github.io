<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FV3DYCORE: fv_mapz_mod Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ccpp_dox_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="UFSLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FV3DYCORE
   &#160;<span id="projectnumber">Version1.0.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacefv__mapz__mod.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">fv_mapz_mod Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The module 'fv_mapz' contains the vertical mapping routines <b>[lin2004vertically]</b>.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a0c56cad3566b5d03032b2c251925ad86"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a0c56cad3566b5d03032b2c251925ad86">lagrangian_to_eulerian</a> (last_step, consv, ps, pe, delp, pkz, pk, mdt, pdt, km, is, ie, js, je, isd, ied, jsd, jed, nq, nwat, sphum, q_con, u, v, w, delz, pt, q, hs, r_vir, cp, akap, cappa, kord_mt, kord_wz, kord_tr, kord_tm, peln, te0_2d, ng, ua, va, omga, te, ws, fill, reproduce_sum, out_dt, dtdt, ptop, ak, bk, pfull, gridstruct, domain, do_sat_adj, hydrostatic, hybrid_z, do_omega, adiabatic, do_adiabatic_init)</td></tr>
<tr class="memdesc:a0c56cad3566b5d03032b2c251925ad86"><td class="mdescLeft">&#160;</td><td class="mdescRight">The subroutine 'Lagrangian_to_Eulerian' remaps deformed Lagrangian layers back to the reference Eulerian coordinate.  <a href="#a0c56cad3566b5d03032b2c251925ad86">More...</a><br /></td></tr>
<tr class="separator:a0c56cad3566b5d03032b2c251925ad86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a88277aeaf10321b9ba0d0fbeaef1d9"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a9a88277aeaf10321b9ba0d0fbeaef1d9">compute_total_energy</a> (is, ie, js, je, isd, ied, jsd, jed, km, u, v, w, delz, pt, delp, q, qc, pe, peln, hs, rsin2_l, cosa_s_l, r_vir, cp, rg, hlv, te_2d, ua, va, teq, moist_phys, nwat, sphum, liq_wat, rainwat, ice_wat, snowwat, graupel, hydrostatic, id_te)</td></tr>
<tr class="memdesc:a9a88277aeaf10321b9ba0d0fbeaef1d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The subroutine 'compute_total_energy' performs the FV3-consistent computation of the global total energy.  <a href="#a9a88277aeaf10321b9ba0d0fbeaef1d9">More...</a><br /></td></tr>
<tr class="separator:a9a88277aeaf10321b9ba0d0fbeaef1d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52443e2b2c993b75d4fdeae138398dfc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a52443e2b2c993b75d4fdeae138398dfc">pkez</a> (km, ifirst, ilast, jfirst, jlast, j, pe, pk, akap, peln, pkz, ptop)</td></tr>
<tr class="separator:a52443e2b2c993b75d4fdeae138398dfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65d5b6aa4d7e599b7af0a362b9e96fd2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a65d5b6aa4d7e599b7af0a362b9e96fd2">remap_z</a> (km, pe1, q1, kn, pe2, q2, i1, i2, iv, kord)</td></tr>
<tr class="separator:a65d5b6aa4d7e599b7af0a362b9e96fd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d1b66129cc9014f4dbad93e2b397a2e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a3d1b66129cc9014f4dbad93e2b397a2e">map_scalar</a> (km, pe1, q1, qs, kn, pe2, q2, i1, i2, j, ibeg, iend, jbeg, jend, iv, kord, q_min)</td></tr>
<tr class="separator:a3d1b66129cc9014f4dbad93e2b397a2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35a873aa5bd84ccf2d0a71bd96b0eaff"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a35a873aa5bd84ccf2d0a71bd96b0eaff">map1_ppm</a> (km, pe1, q1, qs, kn, pe2, q2, i1, i2, j, ibeg, iend, jbeg, jend, iv, kord)</td></tr>
<tr class="separator:a35a873aa5bd84ccf2d0a71bd96b0eaff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90a838ddc038bd2a7d817657f5085eb2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a90a838ddc038bd2a7d817657f5085eb2">mapn_tracer</a> (nq, km, pe1, pe2, q1, dp2, kord, j, i1, i2, isd, ied, jsd, jed, q_min, fill)</td></tr>
<tr class="separator:a90a838ddc038bd2a7d817657f5085eb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae331c105e67cfb16c4d86ff07e5fd110"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#ae331c105e67cfb16c4d86ff07e5fd110">map1_q2</a> (km, pe1, q1, kn, pe2, q2, dp2, i1, i2, iv, kord, j, ibeg, iend, jbeg, jend, q_min)</td></tr>
<tr class="separator:ae331c105e67cfb16c4d86ff07e5fd110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58e331d987fff65d9d89a1c3dfa5c5e4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a58e331d987fff65d9d89a1c3dfa5c5e4">remap_2d</a> (km, pe1, q1, kn, pe2, q2, i1, i2, iv, kord)</td></tr>
<tr class="separator:a58e331d987fff65d9d89a1c3dfa5c5e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae090838204207cbddd0e4d08f382f95b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#ae090838204207cbddd0e4d08f382f95b">scalar_profile</a> (qs, a4, delp, km, i1, i2, iv, kord, qmin)</td></tr>
<tr class="separator:ae090838204207cbddd0e4d08f382f95b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a628ebb3961c9a007434cb29da18e96d6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a628ebb3961c9a007434cb29da18e96d6">cs_profile</a> (qs, a4, delp, km, i1, i2, iv, kord)</td></tr>
<tr class="separator:a628ebb3961c9a007434cb29da18e96d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36cfb1e4c0826ab1202a1ae5245fb6f6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a36cfb1e4c0826ab1202a1ae5245fb6f6">cs_limiters</a> (im, extm, a4, iv)</td></tr>
<tr class="separator:a36cfb1e4c0826ab1202a1ae5245fb6f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94cb1798bfac376db362e29961b22d97"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a94cb1798bfac376db362e29961b22d97">ppm_profile</a> (a4, delp, km, i1, i2, iv, kord)</td></tr>
<tr class="separator:a94cb1798bfac376db362e29961b22d97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea73a4b490462eebec46e902de4731dd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#aea73a4b490462eebec46e902de4731dd">ppm_limiters</a> (dm, a4, itot, lmt)</td></tr>
<tr class="separator:aea73a4b490462eebec46e902de4731dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a819605dd5b0423882b9ce0671f475986"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a819605dd5b0423882b9ce0671f475986">steepz</a> (i1, i2, km, a4, df2, dm, dq, dp, d4)</td></tr>
<tr class="separator:a819605dd5b0423882b9ce0671f475986"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add39354bb1bcbdf4b51fb093c045e8c1"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#add39354bb1bcbdf4b51fb093c045e8c1">rst_remap</a> (km, kn, is, ie, js, je, isd, ied, jsd, jed, nq, ntp, delp_r, u_r, v_r, w_r, delz_r, pt_r, q_r, qdiag_r, delp, u, v, w, delz, pt, q, qdiag, ak_r, bk_r, ptop, ak, bk, hydrostatic, make_nh, domain, square_domain)</td></tr>
<tr class="memdesc:add39354bb1bcbdf4b51fb093c045e8c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The subroutine 'rst_remap' remaps all variables required for a restart.  <a href="#add39354bb1bcbdf4b51fb093c045e8c1">More...</a><br /></td></tr>
<tr class="separator:add39354bb1bcbdf4b51fb093c045e8c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8ee4094f27d3aa103d9101c1a46a5cd"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#ab8ee4094f27d3aa103d9101c1a46a5cd">mappm</a> (km, pe1, q1, kn, pe2, q2, i1, i2, iv, kord, ptop)</td></tr>
<tr class="memdesc:ab8ee4094f27d3aa103d9101c1a46a5cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">The subroutine 'mappm' is a general-purpose routine for remapping one set of vertical levels to another.  <a href="#ab8ee4094f27d3aa103d9101c1a46a5cd">More...</a><br /></td></tr>
<tr class="separator:ab8ee4094f27d3aa103d9101c1a46a5cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e2f210d41b616b0d7fb31e6f624897c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a7e2f210d41b616b0d7fb31e6f624897c">moist_cv</a> (is, ie, isd, ied, jsd, jed, km, j, k, nwat, sphum, liq_wat, rainwat, ice_wat, snowwat, graupel, q, qd, cvm, t1)</td></tr>
<tr class="memdesc:a7e2f210d41b616b0d7fb31e6f624897c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The subroutine 'moist_cv' computes the FV3-consistent moist heat capacity under constant volume, including the heating capacity of water vapor and condensates.  <a href="#a7e2f210d41b616b0d7fb31e6f624897c">More...</a><br /></td></tr>
<tr class="separator:a7e2f210d41b616b0d7fb31e6f624897c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae179a4a6af972dd3480b55f62c1ce72e"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#ae179a4a6af972dd3480b55f62c1ce72e">moist_cp</a> (is, ie, isd, ied, jsd, jed, km, j, k, nwat, sphum, liq_wat, rainwat, ice_wat, snowwat, graupel, q, qd, cpm, t1)</td></tr>
<tr class="memdesc:ae179a4a6af972dd3480b55f62c1ce72e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The subroutine 'moist_cp' computes the FV3-consistent moist heat capacity under constant pressure, including the heating capacity of water vapor and condensates.  <a href="#ae179a4a6af972dd3480b55f62c1ce72e">More...</a><br /></td></tr>
<tr class="separator:ae179a4a6af972dd3480b55f62c1ce72e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7879730f4b2baa275cd6abaf9c369bb5"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a7879730f4b2baa275cd6abaf9c369bb5">consv_min</a> = 0.001</td></tr>
<tr class="memdesc:a7879730f4b2baa275cd6abaf9c369bb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">below which no correction applies  <a href="#a7879730f4b2baa275cd6abaf9c369bb5">More...</a><br /></td></tr>
<tr class="separator:a7879730f4b2baa275cd6abaf9c369bb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cf7f37723bbfb2e7d6b4d948ea81567"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a7cf7f37723bbfb2e7d6b4d948ea81567">t_min</a> = 184.</td></tr>
<tr class="memdesc:a7cf7f37723bbfb2e7d6b4d948ea81567"><td class="mdescLeft">&#160;</td><td class="mdescRight">below which applies stricter constraint  <a href="#a7cf7f37723bbfb2e7d6b4d948ea81567">More...</a><br /></td></tr>
<tr class="separator:a7cf7f37723bbfb2e7d6b4d948ea81567"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85ad5e9000a3d762fd9a62ce59fa9213"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a85ad5e9000a3d762fd9a62ce59fa9213">r3</a> = 1./3.</td></tr>
<tr class="separator:a85ad5e9000a3d762fd9a62ce59fa9213"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24b67f915ffc43180f28b980d9ca7d4c"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a24b67f915ffc43180f28b980d9ca7d4c">r23</a> = 2./3.</td></tr>
<tr class="separator:a24b67f915ffc43180f28b980d9ca7d4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb8dc5fd25041ba11e452a3994360336"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#abb8dc5fd25041ba11e452a3994360336">r12</a> = 1./12.</td></tr>
<tr class="separator:abb8dc5fd25041ba11e452a3994360336"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c1b41c250d4fae86c8297ebe5f71577"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a4c1b41c250d4fae86c8297ebe5f71577">cv_vap</a> = 3.*rvgas</td></tr>
<tr class="memdesc:a4c1b41c250d4fae86c8297ebe5f71577"><td class="mdescLeft">&#160;</td><td class="mdescRight">1384.5  <a href="#a4c1b41c250d4fae86c8297ebe5f71577">More...</a><br /></td></tr>
<tr class="separator:a4c1b41c250d4fae86c8297ebe5f71577"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac280285d39826f98f83043a75f01d44e"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#ac280285d39826f98f83043a75f01d44e">cv_air</a> = cp_air - rdgas</td></tr>
<tr class="memdesc:ac280285d39826f98f83043a75f01d44e"><td class="mdescLeft">&#160;</td><td class="mdescRight">= rdgas * (7/2-1) = 2.5*rdgas=717.68  <a href="#ac280285d39826f98f83043a75f01d44e">More...</a><br /></td></tr>
<tr class="separator:ac280285d39826f98f83043a75f01d44e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa58d5b9a96c7678b42b9f21dae04d56"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#aaa58d5b9a96c7678b42b9f21dae04d56">c_ice</a> = 1972.</td></tr>
<tr class="memdesc:aaa58d5b9a96c7678b42b9f21dae04d56"><td class="mdescLeft">&#160;</td><td class="mdescRight">heat capacity of ice at -15.C  <a href="#aaa58d5b9a96c7678b42b9f21dae04d56">More...</a><br /></td></tr>
<tr class="separator:aaa58d5b9a96c7678b42b9f21dae04d56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0e5a6070f8657332c3dc64bd06f62bc"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#aa0e5a6070f8657332c3dc64bd06f62bc">c_liq</a> = 4.1855e+3</td></tr>
<tr class="memdesc:aa0e5a6070f8657332c3dc64bd06f62bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">GFS: heat capacity of water at 0C.  <a href="#aa0e5a6070f8657332c3dc64bd06f62bc">More...</a><br /></td></tr>
<tr class="separator:aa0e5a6070f8657332c3dc64bd06f62bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefa9aa99fd17c4042bf8dab0df746acc"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#aefa9aa99fd17c4042bf8dab0df746acc">cp_vap</a> = cp_vapor</td></tr>
<tr class="separator:aefa9aa99fd17c4042bf8dab0df746acc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79c88aa388441e010f8532f6802b3240"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a79c88aa388441e010f8532f6802b3240">tice</a> = 273.16</td></tr>
<tr class="separator:a79c88aa388441e010f8532f6802b3240"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f144b640540ec10df24f75e367c2057"><td class="memItemLeft" align="right" valign="top">real(kind=4), public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefv__mapz__mod.html#a5f144b640540ec10df24f75e367c2057">e_flux</a> = 0.</td></tr>
<tr class="separator:a5f144b640540ec10df24f75e367c2057"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The module 'fv_mapz' contains the vertical mapping routines <b>[lin2004vertically]</b>. </p>
<dl class="section note"><dt>Note</dt><dd>April 12, 2012 -SJL: This revision may actually produce rounding level differences due to the elimination of KS to compute pressure level for remapping. </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a9a88277aeaf10321b9ba0d0fbeaef1d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a88277aeaf10321b9ba0d0fbeaef1d9">&#9670;&nbsp;</a></span>compute_total_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fv_mapz_mod::compute_total_energy </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>js</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>je</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>isd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,  jsd:jed+1,km), intent(inout)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied+1,jsd:jed,  km), intent(inout)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:,jsd:,1:), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:,jsd:,1:), intent(in)&#160;</td>
          <td class="paramname"><em>delz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,km), intent(in)&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,km), intent(in)&#160;</td>
          <td class="paramname"><em>delp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,km,*), intent(in)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,km), intent(in)&#160;</td>
          <td class="paramname"><em>qc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is-1:ie+1,km+1,js-1:je+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie,km+1,js:je), intent(in)&#160;</td>
          <td class="paramname"><em>peln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed), intent(in)&#160;</td>
          <td class="paramname"><em>hs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied, jsd:jed), intent(in)&#160;</td>
          <td class="paramname"><em>rsin2_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied, jsd:jed), intent(in)&#160;</td>
          <td class="paramname"><em>cosa_s_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>r_vir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>rg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>hlv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie,js:je), intent(out)&#160;</td>
          <td class="paramname"><em>te_2d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,km), intent(inout)&#160;</td>
          <td class="paramname"><em>ua</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,km), intent(inout)&#160;</td>
          <td class="paramname"><em>va</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie,js:je), intent(out)&#160;</td>
          <td class="paramname"><em>teq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>moist_phys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sphum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>liq_wat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>rainwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ice_wat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>snowwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>graupel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>hydrostatic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>id_te</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The subroutine 'compute_total_energy' performs the FV3-consistent computation of the global total energy. </p>
<p>It includes the potential, internal (latent and sensible heat), kinetic terms.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>vertical velocity (m/s)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hs</td><td>surface geopotential</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pe</td><td>pressure at layer edges</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">peln</td><td>log(pe)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">te_2d</td><td>vertically integrated TE</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">teq</td><td>Moist TE Local </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l00979">979</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a36cfb1e4c0826ab1202a1ae5245fb6f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36cfb1e4c0826ab1202a1ae5245fb6f6">&#9670;&nbsp;</a></span>cs_limiters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fv_mapz_mod::cs_limiters </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(im), intent(in)&#160;</td>
          <td class="paramname"><em>extm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(4,im), intent(inout)&#160;</td>
          <td class="paramname"><em>a4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a4</td><td>PPM array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l02542">2542</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a628ebb3961c9a007434cb29da18e96d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a628ebb3961c9a007434cb29da18e96d6">&#9670;&nbsp;</a></span>cs_profile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fv_mapz_mod::cs_profile </td>
          <td>(</td>
          <td class="paramtype">real, dimension(i1:i2), intent(in)&#160;</td>
          <td class="paramname"><em>qs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(4,i1:i2,km), intent(inout)&#160;</td>
          <td class="paramname"><em>a4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km), intent(in)&#160;</td>
          <td class="paramname"><em>delp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kord</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>vertical dimension</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iv</td><td>iv =-1: winds iv = 0: positive definite scalars iv = 1: others</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delp</td><td>layer pressure thickness</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a4</td><td>Interpolated values </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l02139">2139</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a0c56cad3566b5d03032b2c251925ad86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c56cad3566b5d03032b2c251925ad86">&#9670;&nbsp;</a></span>lagrangian_to_eulerian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fv_mapz_mod::lagrangian_to_eulerian </td>
          <td>(</td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>last_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>consv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed), intent(inout)&#160;</td>
          <td class="paramname"><em>ps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is-1:ie+1,km+1,js-1:je+1), intent(inout)&#160;</td>
          <td class="paramname"><em>pe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,km), intent(inout)&#160;</td>
          <td class="paramname"><em>delp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie,js:je,km), intent(out)&#160;</td>
          <td class="paramname"><em>pkz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie,js:je,km+1), intent(inout)&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>mdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>pdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>js</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>je</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>isd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sphum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:,jsd:,1:), intent(inout)&#160;</td>
          <td class="paramname"><em>q_con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied  ,jsd:jed+1,km), intent(inout)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied+1,jsd:jed  ,km), intent(inout)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:     ,jsd:     ,1:), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:,jsd:,1:), intent(inout)&#160;</td>
          <td class="paramname"><em>delz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied  ,jsd:jed  ,km), intent(inout)&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,km,*), intent(inout)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed), intent(in)&#160;</td>
          <td class="paramname"><em>hs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>r_vir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>akap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:,jsd:,1:), intent(inout)&#160;</td>
          <td class="paramname"><em>cappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kord_mt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kord_wz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nq), intent(in)&#160;</td>
          <td class="paramname"><em>kord_tr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kord_tm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie,km+1,js:je), intent(inout)&#160;</td>
          <td class="paramname"><em>peln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie,js:je), intent(inout)&#160;</td>
          <td class="paramname"><em>te0_2d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,km), intent(inout)&#160;</td>
          <td class="paramname"><em>ua</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,km), intent(inout)&#160;</td>
          <td class="paramname"><em>va</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,km), intent(inout)&#160;</td>
          <td class="paramname"><em>omga</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,km), intent(out)&#160;</td>
          <td class="paramname"><em>te</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie,js:je), intent(in)&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>fill</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>reproduce_sum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>out_dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie,js:je,km), intent(inout)&#160;</td>
          <td class="paramname"><em>dtdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ptop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km+1), intent(in)&#160;</td>
          <td class="paramname"><em>ak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km+1), intent(in)&#160;</td>
          <td class="paramname"><em>bk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>pfull</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structfv__arrays__mod_1_1fv__grid__type.html">fv_grid_type</a>), intent(in), target&#160;</td>
          <td class="paramname"><em>gridstruct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(domain2d), intent(inout)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>do_sat_adj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>hydrostatic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>hybrid_z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>do_omega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>adiabatic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>do_adiabatic_init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The subroutine 'Lagrangian_to_Eulerian' remaps deformed Lagrangian layers back to the reference Eulerian coordinate. </p>
<p>It also includes the entry point for calling fast microphysical processes. This is typically calle on the k_split loop.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mdt</td><td>remap time step</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pdt</td><td>phys time step</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nq</td><td>number of tracers (including h2o)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sphum</td><td>index for water vapor (specific humidity)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ied</td><td>starting &amp; ending X-Dir index</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jed</td><td>starting &amp; ending Y-Dir index</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kord_mt</td><td>Mapping order for the vector winds</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kord_wz</td><td>Mapping order/option for w</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kord_tr</td><td>Mapping order for tracers</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kord_tm</td><td>Mapping order for thermodynamics</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">consv</td><td>factor for TE conservation</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hs</td><td>surface geopotential</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fill</td><td>fill negative tracers</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pk</td><td>pe to the kappa</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">delp</td><td>pressure thickness</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pe</td><td>pressure at layer edges</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ps</td><td>surface pressure</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">u</td><td>u-wind (m/s)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">v</td><td>v-wind (m/s)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">w</td><td>vertical velocity (m/s)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pt</td><td>cp*virtual potential temperature as input; output: temperature</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ua</td><td>u-wind (m/s) on physics grid</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">va</td><td>v-wind (m/s) on physics grid</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">omga</td><td>vertical press. velocity (pascal/sec)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">peln</td><td>log(pe)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pkz</td><td>layer-mean pk for converting t to pt </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l00145">145</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a35a873aa5bd84ccf2d0a71bd96b0eaff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35a873aa5bd84ccf2d0a71bd96b0eaff">&#9670;&nbsp;</a></span>map1_ppm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fv_mapz_mod::map1_ppm </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ibeg:iend,jbeg:jend,km), intent(in)&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2), intent(in)&#160;</td>
          <td class="paramname"><em>qs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,kn+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ibeg:iend,jbeg:jend,kn), intent(inout)&#160;</td>
          <td class="paramname"><em>q2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ibeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jbeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kord</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">i1</td><td>Starting longitude</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i2</td><td>Finishing longitude</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iv</td><td>Mode: 0 == constituents 1 == ??? 2 == remap temp with cs scheme</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kord</td><td>Method order</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Current latitude</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>Original vertical dimension</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kn</td><td>Target vertical dimension</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qs</td><td>bottom BC</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pe1</td><td>pressure at layer edges from model top to bottom surface in the original vertical coordinate</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pe2</td><td>pressure at layer edges from model top to bottom surface in the new vertical coordinate</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q1</td><td>Field input</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q2</td><td>Field output </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l01352">1352</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="ae331c105e67cfb16c4d86ff07e5fd110"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae331c105e67cfb16c4d86ff07e5fd110">&#9670;&nbsp;</a></span>map1_q2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fv_mapz_mod::map1_q2 </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ibeg:iend,jbeg:jend,km), intent(in)&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,kn+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,kn), intent(inout)&#160;</td>
          <td class="paramname"><em>q2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,kn), intent(in)&#160;</td>
          <td class="paramname"><em>dp2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ibeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jbeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>q_min</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iv</td><td>Mode: 0 == constituents 1 == ???</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>Original vertical dimension</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kn</td><td>Target vertical dimension</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pe1</td><td>pressure at layer edges from model top to bottom surface in the original vertical coordinate</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pe2</td><td>pressure at layer edges from model top to bottom surface in the new vertical coordinate</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q1</td><td>Field input</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q2</td><td>Field output </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l01554">1554</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a3d1b66129cc9014f4dbad93e2b397a2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d1b66129cc9014f4dbad93e2b397a2e">&#9670;&nbsp;</a></span>map_scalar()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fv_mapz_mod::map_scalar </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ibeg:iend,jbeg:jend,km), intent(in)&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2), intent(in)&#160;</td>
          <td class="paramname"><em>qs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,kn+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ibeg:iend,jbeg:jend,kn), intent(inout)&#160;</td>
          <td class="paramname"><em>q2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ibeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jbeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>q_min</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">i1</td><td>Starting longitude</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i2</td><td>Finishing longitude</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iv</td><td>Mode: 0 == constituents 1 == temp 2 == remap temp with cs scheme</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kord</td><td>Method order</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>Current latitude</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>Original vertical dimension</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kn</td><td>Target vertical dimension</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qs</td><td>bottom BC</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pe1</td><td>pressure at layer edges from model top to bottom surface in the original vertical coordinate</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pe2</td><td>pressure at layer edges from model top to bottom surface in the new vertical coordinate</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q1</td><td>Field input</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q2</td><td>Field output </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l01262">1262</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a90a838ddc038bd2a7d817657f5085eb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90a838ddc038bd2a7d817657f5085eb2">&#9670;&nbsp;</a></span>mapn_tracer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fv_mapz_mod::mapn_tracer </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,km,nq), intent(inout)&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km), intent(in)&#160;</td>
          <td class="paramname"><em>dp2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nq), intent(in)&#160;</td>
          <td class="paramname"><em>kord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>isd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>q_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>fill</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>vertical dimension</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pe1</td><td>pressure at layer edges from model top to bottom surface in the original vertical coordinate</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pe2</td><td>pressure at layer edges from model top to bottom surface in the new vertical coordinate </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l01440">1440</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="ab8ee4094f27d3aa103d9101c1a46a5cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8ee4094f27d3aa103d9101c1a46a5cd">&#9670;&nbsp;</a></span>mappm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fv_mapz_mod::mappm </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km), intent(in)&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,kn+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,kn), intent(out)&#160;</td>
          <td class="paramname"><em>q2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ptop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The subroutine 'mappm' is a general-purpose routine for remapping one set of vertical levels to another. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pe2</td><td>pe1: pressure at layer edges from model top to bottom surface in the ORIGINAL vertical coordinate pe2: pressure at layer edges from model top to bottom surface in the NEW vertical coordinate </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l03300">3300</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="ae179a4a6af972dd3480b55f62c1ce72e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae179a4a6af972dd3480b55f62c1ce72e">&#9670;&nbsp;</a></span>moist_cp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fv_mapz_mod::moist_cp </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>isd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sphum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>liq_wat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>rainwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ice_wat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>snowwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>graupel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,km,nwat), intent(in)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie), intent(out)&#160;</td>
          <td class="paramname"><em>qd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie), intent(out)&#160;</td>
          <td class="paramname"><em>cpm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie), intent(in), optional&#160;</td>
          <td class="paramname"><em>t1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The subroutine 'moist_cp' computes the FV3-consistent moist heat capacity under constant pressure, including the heating capacity of water vapor and condensates. </p>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l03540">3540</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a7e2f210d41b616b0d7fb31e6f624897c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e2f210d41b616b0d7fb31e6f624897c">&#9670;&nbsp;</a></span>moist_cv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fv_mapz_mod::moist_cv </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>isd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sphum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>liq_wat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>rainwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ice_wat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>snowwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>graupel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,km,nwat), intent(in)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie), intent(out)&#160;</td>
          <td class="paramname"><em>qd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie), intent(out)&#160;</td>
          <td class="paramname"><em>cvm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie), intent(in), optional&#160;</td>
          <td class="paramname"><em>t1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The subroutine 'moist_cv' computes the FV3-consistent moist heat capacity under constant volume, including the heating capacity of water vapor and condensates. </p>
<p>See <b>[emanuel1994atmospheric]</b> for information on variable heat capacities. </p>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l03437">3437</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a52443e2b2c993b75d4fdeae138398dfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52443e2b2c993b75d4fdeae138398dfc">&#9670;&nbsp;</a></span>pkez()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fv_mapz_mod::pkez </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ifirst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ilast</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jfirst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jlast</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ifirst-1:ilast+1,km+1,jfirst-1:jlast+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ifirst:ilast,jfirst:jlast,km+1), intent(in)&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>akap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ifirst:ilast, km+1, jfirst:jlast), intent(inout)&#160;</td>
          <td class="paramname"><em>peln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ifirst:ilast,jfirst:jlast,km), intent(out)&#160;</td>
          <td class="paramname"><em>pkz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ptop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ilast</td><td>Latitude strip</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jlast</td><td>Latitude strip</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">peln</td><td>log (pe) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l01120">1120</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="aea73a4b490462eebec46e902de4731dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea73a4b490462eebec46e902de4731dd">&#9670;&nbsp;</a></span>ppm_limiters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fv_mapz_mod::ppm_limiters </td>
          <td>(</td>
          <td class="paramtype">real, dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>dm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(4,*), intent(inout)&#160;</td>
          <td class="paramname"><em>a4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>itot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lmt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dm</td><td>Linear slope</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">itot</td><td>Total Longitudes</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lmt</td><td>0: Standard PPM constraint 1: Improved full monotonicity constraint (Lin) 2: Positive definite constraint 3: do nothing (return immediately)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a4</td><td>PPM array AA &lt;&ndash; a4(1,i) AL &lt;&ndash; a4(2,i) AR &lt;&ndash; a4(3,i) A6 &lt;&ndash; a4(4,i) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l02878">2878</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a94cb1798bfac376db362e29961b22d97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94cb1798bfac376db362e29961b22d97">&#9670;&nbsp;</a></span>ppm_profile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fv_mapz_mod::ppm_profile </td>
          <td>(</td>
          <td class="paramtype">real, dimension(4,i1:i2,km), intent(inout)&#160;</td>
          <td class="paramname"><em>a4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km), intent(in)&#160;</td>
          <td class="paramname"><em>delp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kord</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iv</td><td>iv =-1: winds iv = 0: positive definite scalars iv = 1: others iv = 2: temp (if remap_t) and w (iv=-2)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i1</td><td>Starting longitude</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i2</td><td>Finishing longitude</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>Vertical dimension</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kord</td><td>Order (or more accurately method no.):</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delp</td><td>Layer pressure thickness</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a4</td><td>Interpolated values </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l02621">2621</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a58e331d987fff65d9d89a1c3dfa5c5e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58e331d987fff65d9d89a1c3dfa5c5e4">&#9670;&nbsp;</a></span>remap_2d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fv_mapz_mod::remap_2d </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km), intent(in)&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,kn+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,kn), intent(out)&#160;</td>
          <td class="paramname"><em>q2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kord</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iv</td><td>Mode: 0 == constituents 1 ==others</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>Original vertical dimension</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kn</td><td>Target vertical dimension</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pe1</td><td>Pressure at layer edges from model top to bottom surface in the original vertical coordinate</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pe2</td><td>Pressure at layer edges from model top to bottom surface in the new vertical coordinate</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q1</td><td>Field input</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">q2</td><td>Field output </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l01643">1643</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a65d5b6aa4d7e599b7af0a362b9e96fd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65d5b6aa4d7e599b7af0a362b9e96fd2">&#9670;&nbsp;</a></span>remap_z()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fv_mapz_mod::remap_z </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km), intent(in)&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,kn+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,kn), intent(inout)&#160;</td>
          <td class="paramname"><em>q2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kord</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">i1</td><td>Starting longitude</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i2</td><td>Finishing longitude</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kord</td><td>Method order</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>Original vertical dimension</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kn</td><td>Target vertical dimension</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pe1</td><td>height at layer edges from model top to bottom surface</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pe2</td><td>height at layer edges from model top to bottom surface</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q1</td><td>Field input</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q2</td><td>Field output </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l01178">1178</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="add39354bb1bcbdf4b51fb093c045e8c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add39354bb1bcbdf4b51fb093c045e8c1">&#9670;&nbsp;</a></span>rst_remap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fv_mapz_mod::rst_remap </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>js</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>je</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>isd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ntp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie,js:je,km), intent(in)&#160;</td>
          <td class="paramname"><em>delp_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie,  js:je+1,km), intent(in)&#160;</td>
          <td class="paramname"><em>u_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie+1,js:je  ,km), intent(in)&#160;</td>
          <td class="paramname"><em>v_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie,js:je,km), intent(in)&#160;</td>
          <td class="paramname"><em>w_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie,js:je,km), intent(inout)&#160;</td>
          <td class="paramname"><em>delz_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie,js:je,km), intent(inout)&#160;</td>
          <td class="paramname"><em>pt_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie,js:je,km,1:ntp), intent(in)&#160;</td>
          <td class="paramname"><em>q_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(is:ie,js:je,km,ntp+1:nq), intent(in)&#160;</td>
          <td class="paramname"><em>qdiag_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,kn), intent(out)&#160;</td>
          <td class="paramname"><em>delp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied  ,jsd:jed+1,kn), intent(out)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied+1,jsd:jed  ,kn), intent(out)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:     ,jsd:     ,1:), intent(out)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:,jsd:,1:), intent(out)&#160;</td>
          <td class="paramname"><em>delz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied  ,jsd:jed  ,kn), intent(out)&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,kn,1:ntp), intent(out)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(isd:ied,jsd:jed,kn,ntp+1:nq), intent(out)&#160;</td>
          <td class="paramname"><em>qdiag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km+1), intent(in)&#160;</td>
          <td class="paramname"><em>ak_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km+1), intent(in)&#160;</td>
          <td class="paramname"><em>bk_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ptop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kn+1), intent(in)&#160;</td>
          <td class="paramname"><em>ak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kn+1), intent(in)&#160;</td>
          <td class="paramname"><em>bk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>hydrostatic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>make_nh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(domain2d), intent(inout)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>square_domain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The subroutine 'rst_remap' remaps all variables required for a restart. </p>
<p>npz_restart /= npz (i.e., when the number of vertical levels is changed at restart)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>Restart z-dimension</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kn</td><td>Run time dimension</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ntp</td><td>Number of tracers (including H2O)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ied</td><td>Starting &amp; ending X-Dir index</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jed</td><td>Starting &amp; ending Y-Dir index</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delp_r</td><td>Pressure thickness</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u_r</td><td>u-wind (m/s)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v_r</td><td>v-wind (m/s)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">delp</td><td>Pressure thickness</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">u</td><td>u-wind (m/s)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">v</td><td>v-wind (m/s)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">w</td><td>Vertical velocity (m/s)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pt</td><td>Temperature</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">delz</td><td>Delta-height (m) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l03018">3018</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="ae090838204207cbddd0e4d08f382f95b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae090838204207cbddd0e4d08f382f95b">&#9670;&nbsp;</a></span>scalar_profile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fv_mapz_mod::scalar_profile </td>
          <td>(</td>
          <td class="paramtype">real, dimension(i1:i2), intent(in)&#160;</td>
          <td class="paramname"><em>qs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(4,i1:i2,km), intent(inout)&#160;</td>
          <td class="paramname"><em>a4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km), intent(in)&#160;</td>
          <td class="paramname"><em>delp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>qmin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>vertical dimension</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iv</td><td>iv =-1: winds iv = 0: positive definite scalars iv = 1: others</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delp</td><td>Layer pressure thickness</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a4</td><td>Interpolated values </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l01732">1732</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a819605dd5b0423882b9ce0671f475986"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a819605dd5b0423882b9ce0671f475986">&#9670;&nbsp;</a></span>steepz()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fv_mapz_mod::steepz </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(4,i1:i2,km), intent(inout)&#160;</td>
          <td class="paramname"><em>a4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km), intent(in)&#160;</td>
          <td class="paramname"><em>df2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km), intent(in)&#160;</td>
          <td class="paramname"><em>dm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km), intent(in)&#160;</td>
          <td class="paramname"><em>dq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km), intent(in)&#160;</td>
          <td class="paramname"><em>dp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(i1:i2,km), intent(in)&#160;</td>
          <td class="paramname"><em>d4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dp</td><td>Grid size</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dq</td><td>Backward diff of q</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d4</td><td>Backward sum: dp(k)+ dp(k-1)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">df2</td><td>First guess mismatch</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dm</td><td>Monotonic mismatch</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a4</td><td>First guess/steepened </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l02958">2958</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aaa58d5b9a96c7678b42b9f21dae04d56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa58d5b9a96c7678b42b9f21dae04d56">&#9670;&nbsp;</a></span>c_ice</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter fv_mapz_mod::c_ice = 1972.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>heat capacity of ice at -15.C </p>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l00121">121</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="aa0e5a6070f8657332c3dc64bd06f62bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0e5a6070f8657332c3dc64bd06f62bc">&#9670;&nbsp;</a></span>c_liq</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter fv_mapz_mod::c_liq = 4.1855e+3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GFS: heat capacity of water at 0C. </p>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l00122">122</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a7879730f4b2baa275cd6abaf9c369bb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7879730f4b2baa275cd6abaf9c369bb5">&#9670;&nbsp;</a></span>consv_min</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter fv_mapz_mod::consv_min = 0.001</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>below which no correction applies </p>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l00115">115</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="aefa9aa99fd17c4042bf8dab0df746acc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefa9aa99fd17c4042bf8dab0df746acc">&#9670;&nbsp;</a></span>cp_vap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter fv_mapz_mod::cp_vap = cp_vapor</td>
        </tr>
      </table>
</div><div class="memdoc">
<ol type="1">
<li></li>
</ol>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l00124">124</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="ac280285d39826f98f83043a75f01d44e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac280285d39826f98f83043a75f01d44e">&#9670;&nbsp;</a></span>cv_air</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter fv_mapz_mod::cv_air = cp_air - rdgas</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>= rdgas * (7/2-1) = 2.5*rdgas=717.68 </p>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l00119">119</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a4c1b41c250d4fae86c8297ebe5f71577"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c1b41c250d4fae86c8297ebe5f71577">&#9670;&nbsp;</a></span>cv_vap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter fv_mapz_mod::cv_vap = 3.*rvgas</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>1384.5 </p>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l00118">118</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a5f144b640540ec10df24f75e367c2057"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f144b640540ec10df24f75e367c2057">&#9670;&nbsp;</a></span>e_flux</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=4), public fv_mapz_mod::e_flux = 0.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l00127">127</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="abb8dc5fd25041ba11e452a3994360336"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb8dc5fd25041ba11e452a3994360336">&#9670;&nbsp;</a></span>r12</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter fv_mapz_mod::r12 = 1./12.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l00117">117</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a24b67f915ffc43180f28b980d9ca7d4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24b67f915ffc43180f28b980d9ca7d4c">&#9670;&nbsp;</a></span>r23</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter fv_mapz_mod::r23 = 2./3.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l00117">117</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a85ad5e9000a3d762fd9a62ce59fa9213"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85ad5e9000a3d762fd9a62ce59fa9213">&#9670;&nbsp;</a></span>r3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter fv_mapz_mod::r3 = 1./3.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l00117">117</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a7cf7f37723bbfb2e7d6b4d948ea81567"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cf7f37723bbfb2e7d6b4d948ea81567">&#9670;&nbsp;</a></span>t_min</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter fv_mapz_mod::t_min = 184.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>below which applies stricter constraint </p>

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l00116">116</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
<a id="a79c88aa388441e010f8532f6802b3240"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79c88aa388441e010f8532f6802b3240">&#9670;&nbsp;</a></span>tice</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter fv_mapz_mod::tice = 273.16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fv__mapz_8F90_source.html#l00125">125</a> of file <a class="el" href="fv__mapz_8F90_source.html">fv_mapz.F90</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefv__mapz__mod.html">fv_mapz_mod</a></li>
    <li class="footer">Generated on Thu Mar 5 2020 17:54:32 for FV3DYCORE by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
