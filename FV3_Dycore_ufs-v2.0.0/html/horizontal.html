<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FV3DYCORE: The horizontal discretization and Lagrangian Dynamics</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="UFSLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FV3DYCORE
   &#160;<span id="projectnumber">Version 2.0.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('horizontal.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">The horizontal discretization and Lagrangian Dynamics </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Chapter 5</h2>
<p>GFDL will provide the additional documentation by the end of May 2021.</p>
<p>(This information is a reproduction of Section 5 from HCZC20)</p>
<h3>5.1 Dynamics along Lagrangian surfaces</h3>
<p>The layer-integrated equations (4.3) are discretized along the Lagrangian surfaces and integrated on the “acoustic” or “dynamical” time step \(\delta t\) using forward-backward time-stepping as in LR97. The vertical velocity \(w\) is a three-dimensional cell-mean value and partially advanced using the advection scheme. The geometric layer depth \(\delta z\) is simply the difference of the heights of the successive layer interfaces, which with \(\delta p^*\) defines the layer-mean density and the location of the Lagrangian surfaces. The air mass is the total air mass, including water vapor and condensate species.</p>
<p>FV<sup>3</sup> places the wind components using the D-grid (following Arakawa’s terminology), which defines the winds as face-tangential quantities. The D-grid permits us to compute the cell-mean absolute vorticity \(\Omega\) exactly using Stokes’ theorem and a cell-mean value of the local Coriolis parameter \(f\), without performing any averages or interpolations. The wind components themselves are face-mean values “along the cell edges” (not cell-mean values).</p>
<p>Following the notation from L04, PL07, and HL13, we can write the discretized forms of (4.3), excluding the vertical components, as:</p>
<p class="formulaDsp">
\[ \delta p^{*(n + 1)} = \delta p^{*n} + F[\tilde{u^*}, \delta p_y] + G [\tilde{v^*}, \delta p_x] \\ \tag {5.1} \]
</p>
<p class="formulaDsp">
\[ \Theta^{n + 1} = \frac{1}{\delta p^{*(n+1)}} [\Theta^n \delta p^{*n} + F[X^*, \Theta_y] + G[Y^*, \Theta_x]] \\ \tag {5.2} \]
</p>
<p class="formulaDsp">
\[ w^* = \frac{1}{\delta p^{*(n+!)}} [w^n \delta p^{*n} + F[X^*, w_y] + G[Y^*, w_x]] \\ \tag {5.3} \]
</p>
<p class="formulaDsp">
\[ u^{n + 1} = u^n + \triangle \tau [Y(\tilde{v^*}, \Omega_x) - \delta_x (K^* -v \nabla^2 D) + \hat{P_x}] \\ \tag {5.4} \]
</p>
<p class="formulaDsp">
\[ v^{n + 1} = v^n + \triangle \tau [X(\tilde{u^*}, \Omega_y) - \delta_y (K^* -v \nabla^2 D) + \hat{P_y}] \\ \tag {5.5} \]
</p>
<p>The quantities \(\hat{P_x}\) \(\hat{P_y}\) are the horizontal pressure-gradient force terms computed as in L97, the primary difference being that the forces due to hydrostatic and nonhydrostatic pressures arecomputed separately, and that the hydrostatic pressure gradient computation uses the log of the pressure to improve accuracy. The vertical nonhydrostatic pressure-gradient force is evaluated by the semi-implicit solver described in Chapter 5; only the forward advection of \(w\) is performed during the Lagrangian dynamics, producing a partially-updated \(w^*\).</p>
<p>For stability, the pressure gradient force is evaluated backwards-in-time: the flux terms in the momentum, mass, and entropy equations are evaluated forward by the advection scheme, and the resulting updated fields are used to compute the pressure gradient force. This forward-backward time-stepping is stable without needing to use predictor-corrector or Runge-Kutta methods.</p>
<p>In nonhydrostatic simulations it is recommended that the time off-centering for the horizontal pressure-gradient force be consistent with that used in the semi-implicit solver, which includes the vertical nonhydrostatic pressure-gradient force computation,to ensure consistency between the two. If the semi-implicit solver is run fully-implicit \((\alpha=1)\) then the pressure-gradient force should be evaluated fully backward \((\beta = 0)\); otherwise use \(\beta = 1 - \alpha\) </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Feb 24 2021 08:04:37 for FV3DYCORE by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
