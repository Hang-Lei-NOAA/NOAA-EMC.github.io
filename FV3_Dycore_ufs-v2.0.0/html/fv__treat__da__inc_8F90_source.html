<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FV3DYCORE: /home/mji/GFDL_atmos_cubed_sphere/tools/fv_treat_da_inc.F90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="UFSLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FV3DYCORE
   &#160;<span id="projectnumber">Version 2.0.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('fv__treat__da__inc_8F90_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">fv_treat_da_inc.F90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="fv__treat__da__inc_8F90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!***********************************************************************</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!*                   GNU Lesser General Public License                 </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!*</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!* This file is part of the FV3 dynamical core.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!*</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!* The FV3 dynamical core is free software: you can redistribute it </span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!* and/or modify it under the terms of the</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!* GNU Lesser General Public License as published by the</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!* Free Software Foundation, either version 3 of the License, or </span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!* (at your option) any later version.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!*</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!* The FV3 dynamical core is distributed in the hope that it will be </span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!* useful, but WITHOUT ANYWARRANTY; without even the implied warranty </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!* of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!* See the GNU General Public License for more details.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!*</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!* You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!* License along with the FV3 dynamical core.  </span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!* If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!***********************************************************************</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">!  REVISION HISTORY:</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">!  02/12/2016 - Initial Version</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#ifdef OVERLOAD_R4</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define _GET_VAR1 get_var1_real </span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#else</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define _GET_VAR1 get_var1_double</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="namespacefv__treat__da__inc__mod.html">   46</a></span>&#160;<span class="keyword">module</span> <a class="code" href="namespacefv__treat__da__inc__mod.html">fv_treat_da_inc_mod</a></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">! &lt;table&gt;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">! &lt;tr&gt;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">!     &lt;th&gt;Module Name&lt;/th&gt;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">!     &lt;th&gt;Functions Included&lt;/th&gt;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">!   &lt;/tr&gt;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">!   &lt;tr&gt;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">!     &lt;td&gt;constants_mod&lt;/td&gt;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">!     &lt;td&gt;pi=&gt;pi_8, omega, grav, kappa, rdgas, rvgas, cp_air&lt;/td&gt;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">!   &lt;/tr&gt;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">!   &lt;tr&gt;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">!     &lt;td&gt;field_manager_mod&lt;/td&gt;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">!     &lt;td&gt;MODEL_ATMOS&lt;/td&gt;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">!   &lt;/tr&gt;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">!   &lt;tr&gt;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">!     &lt;td&gt;fms_mod&lt;/td&gt;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">!     &lt;td&gt;file_exist, open_namelist_file,close_file, error_mesg, FATAL,</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">!         check_nml_error, stdlog,write_version_number,set_domain,</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">!         mpp_clock_id, mpp_clock_begin, mpp_clock_end, CLOCK_SUBCOMPONENT, </span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">!         clock_flag_default, nullify_domain&lt;/td&gt;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">!   &lt;/tr&gt;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">!   &lt;tr&gt;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">!     &lt;td&gt;fv_arrays_mod&lt;/td&gt;</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">!     &lt;td&gt;fv_atmos_type, fv_grid_type, fv_grid_bounds_type,</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">!          R_GRID&lt;/td&gt;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">!   &lt;/tr&gt;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">!   &lt;tr&gt;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">!     &lt;td&gt;fv_control_mod&lt;/td&gt;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">!     &lt;td&gt;fv_init, fv_end, ngrids&lt;/td&gt;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">!   &lt;/tr&gt;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">!   &lt;tr&gt;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">!     &lt;td&gt;fv_grid_utils_mod&lt;/td&gt;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">!     &lt;td&gt;ptop_min, g_sum, mid_pt_sphere, get_unit_vect2,</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">!         get_latlon_vector, inner_prod, cubed_to_latlon&lt;/td&gt;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">!   &lt;/tr&gt;</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">!   &lt;tr&gt;</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">!     &lt;td&gt;fms_mod&lt;/td&gt;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">!     &lt;td&gt;file_exist, read_data, field_exist, write_version_number&lt;/td&gt;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">!   &lt;/tr&gt;</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">!   &lt;tr&gt;</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">!     &lt;td&gt;fv_mp_mod&lt;/td&gt;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">!     &lt;td&gt;ng,is_master,fill_corners,YDir,mp_reduce_min, mp_reduce_max&lt;/td&gt;</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">!   &lt;/tr&gt;</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">!   &lt;tr&gt;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">!     &lt;td&gt;mpp_mod&lt;/td&gt;</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">!     &lt;td&gt;mpp_error, FATAL, NOTE, mpp_pe&lt;/td&gt;</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">!   &lt;/tr&gt;</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">!   &lt;tr&gt;</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">!     &lt;td&gt;mpp_domains_mod&lt;/td&gt;</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">!     &lt;td&gt;mpp_get_tile_id, domain2d, mpp_update_domains,NORTH, EAST&lt;/td&gt;</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">!   &lt;/tr&gt;</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">!   &lt;tr&gt;</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">!     &lt;td&gt;sim_nc_mod&lt;/td&gt;</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">!     &lt;td&gt;open_ncfile, close_ncfile, get_ncdim1, get_var1_double, </span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">!         get_var2_real, get_var3_r4, get_var1_real&lt;/td&gt;</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">!   &lt;/tr&gt;</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">!   &lt;tr&gt;</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">!     &lt;td&gt;tracer_manager_mod&lt;/td&gt;</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">!     &lt;td&gt;get_tracer_names, get_number_tracers, get_tracer_index&lt;/td&gt;</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">!   &lt;/tr&gt;</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">! &lt;/table&gt;</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">use </span>fms_mod<span class="keywordtype">,           only</span>: file_exist, read_data, &amp;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                               field_exist, write_version_number</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">use </span>mpp_mod<span class="keywordtype">,           only</span>: mpp_error, fatal, note, mpp_pe</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">use </span>mpp_domains_mod<span class="keywordtype">,   only</span>: mpp_get_tile_id, &amp;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                               domain2d, &amp;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                               mpp_update_domains, &amp;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                               north, &amp;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                               east</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordtype">use </span>tracer_manager_mod<span class="keywordtype">,only</span>: get_tracer_names, &amp;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                               get_number_tracers, &amp;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                               get_tracer_index</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordtype">use </span>field_manager_mod<span class="keywordtype">, only</span>: model_atmos</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordtype">use </span>constants_mod<span class="keywordtype">,     only</span>: pi=&gt;pi_8, omega, grav, kappa, &amp;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                               rdgas, rvgas, cp_air</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespacefv__arrays__mod.html">fv_arrays_mod</a><span class="keywordtype">,     only</span>: <a class="code" href="structfv__arrays__mod_1_1fv__atmos__type.html">fv_atmos_type</a>, &amp;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                               <a class="code" href="structfv__arrays__mod_1_1fv__grid__type.html">fv_grid_type</a>, &amp;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                               <a class="code" href="structfv__arrays__mod_1_1fv__grid__bounds__type.html">fv_grid_bounds_type</a>, &amp;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                               <a class="code" href="namespacefv__arrays__mod.html#ab0ba8527d270f349a84fa0a330be1923">r_grid</a></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespacefv__grid__utils__mod.html">fv_grid_utils_mod</a><span class="keywordtype">, only</span>: <a class="code" href="namespacefv__grid__utils__mod.html#a8363bc8f261396e37744efbbfa91fb7d">ptop_min</a>, <a class="code" href="namespacefv__grid__utils__mod.html#acf53e76b1bc9e689efe4900919cd05ef">g_sum</a>, &amp;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                               <a class="code" href="namespacefv__grid__utils__mod.html#a18ebcb54063bc4dc159f2a87771d4358">mid_pt_sphere</a>, <a class="code" href="namespacefv__grid__utils__mod.html#a092aabe65224216e6209babe7f15669e">get_unit_vect2</a>, &amp;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                               <a class="code" href="namespacefv__grid__utils__mod.html#a6a6f485efd42e62b7eeb21509b0200cf">get_latlon_vector</a>, <a class="code" href="namespacefv__grid__utils__mod.html#a9e4bf88962e6eecc388ca075e641d13f">inner_prod</a>, &amp;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                               <a class="code" href="namespacefv__grid__utils__mod.html#a7350d132e32d908f113d772b833eab8a">cubed_to_latlon</a></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespacefv__mp__mod.html">fv_mp_mod</a><span class="keywordtype">,         only</span>: is_master, &amp;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                               fill_corners, &amp;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                               ydir, &amp;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                               mp_reduce_min, &amp;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                               mp_reduce_max</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespacesim__nc__mod.html">sim_nc_mod</a><span class="keywordtype">,        only</span>: <a class="code" href="namespacesim__nc__mod.html#aba132435cdbc967cae6289d8de91c642">open_ncfile</a>, &amp;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                               <a class="code" href="namespacesim__nc__mod.html#a0723aaca20b4f506ff134f191c9c2773">close_ncfile</a>, &amp;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                               <a class="code" href="namespacesim__nc__mod.html#ae7821440ac92334fb40992fd22fb611c">get_ncdim1</a>, &amp;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                               <a class="code" href="namespacesim__nc__mod.html#ace9b6fd17d5ca314e8ad1cd4dfbeac4b">get_var1_double</a>, &amp;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                               <a class="code" href="namespacesim__nc__mod.html#a0d037f885e13796e5464178753a4f7c0">get_var2_real</a>,   &amp;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                               <a class="code" href="namespacesim__nc__mod.html#aeef43827235a8f2bc87c811ae6f047c0">get_var3_r4</a>, &amp;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                               <a class="code" href="namespacesim__nc__mod.html#accbb162bf22e5a5d2b9de65c8db7b3f1">get_var1_real</a>, &amp;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                               <a class="code" href="namespacesim__nc__mod.html#aa1c1534dbde8d5215e5c8fd8d56473b0">check_var_exists</a></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordtype">private</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordtype">public</span> :: <a class="code" href="namespacefv__treat__da__inc__mod.html#a4b6d49f107df211d528692da62142717">read_da_inc</a>,<a class="code" href="namespacefv__treat__da__inc__mod.html#acab756110e27cca6ad9d1d30e4e33444">remap_coef</a></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keyword">contains</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">!=============================================================================</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keyword">   subroutine </span><a class="code" href="namespacefv__treat__da__inc__mod.html#a4b6d49f107df211d528692da62142717">read_da_inc</a>(Atm, fv_domain, bd, npz_in, nq, u, v, q, delp, pt, delz, is_in, js_in, ie_in, je_in,  &amp;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                                                                   isc_in, jsc_in, iec_in, jec_in )</div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="namespacefv__treat__da__inc__mod.html#a4b6d49f107df211d528692da62142717">  160</a></span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structfv__arrays__mod_1_1fv__atmos__type.html">fv_atmos_type</a>),       <span class="keywordtype">intent(inout)</span> :: Atm</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">type</span>(domain2d),            <span class="keywordtype">intent(inout)</span> :: fv_domain</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structfv__arrays__mod_1_1fv__grid__bounds__type.html">fv_grid_bounds_type</a>), <span class="keywordtype">intent(IN)</span> :: bd</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordtype">integer</span>,                   <span class="keywordtype">intent(IN)</span> :: npz_in, nq, is_in, js_in, ie_in, je_in, isc_in, jsc_in, iec_in, jec_in</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordtype">real</span>, <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(is_in:ie_in,  js_in:je_in+1,npz_in)</span>:: u  <span class="comment">! D grid zonal wind (m/s)</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordtype">real</span>, <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(is_in:ie_in+1,js_in:je_in  ,npz_in)</span>:: v  <span class="comment">! D grid meridional wind (m/s)</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">real</span>, <span class="keywordtype">intent(inout)</span> :: delp(is_in:ie_in  ,js_in:je_in  ,npz_in)  <span class="comment">! pressure thickness (pascal)</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordtype">real</span>, <span class="keywordtype">intent(inout)</span> :: pt(  is_in:ie_in  ,js_in:je_in  ,npz_in)  <span class="comment">! temperature (K)</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">real</span>, <span class="keywordtype">intent(inout)</span> :: q(   is_in:ie_in  ,js_in:je_in  ,npz_in, nq)  <span class="comment">! </span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordtype">real</span>, <span class="keywordtype">intent(inout)</span> :: delz(isc_in:iec_in  ,jsc_in:jec_in  ,npz_in)  <span class="comment">! </span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">! local</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    </div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordtype">real</span> :: deg2rad</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">character(len=128)</span> :: fname</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">real(kind=4)</span>, <span class="keywordtype">allocatable</span>:: wk1(:), wk2(:,:), wk3(:,:,:)</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">real(kind=4)</span>, <span class="keywordtype">allocatable</span>:: wk3_u(:,:,:), wk3_v(:,:,:)</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span>:: tp(:,:,:), qp(:,:,:)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">real</span>, <span class="keywordtype">dimension(:,:,:)</span>, <span class="keywordtype">allocatable</span>:: u_inc, v_inc, ud_inc, vd_inc</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span>:: lat(:), lon(:)</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span>:: pt_c(:,:,:), pt_d(:,:,:)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordtype">real</span>:: s2c(atm%bd%is:atm%bd%ie,atm%bd%js:atm%bd%je,4)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordtype">real</span>:: s2c_c(atm%bd%is:atm%bd%ie+1,atm%bd%js:atm%bd%je,4)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordtype">real</span>:: s2c_d(atm%bd%is:atm%bd%ie,atm%bd%js:atm%bd%je+1,4)</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(Atm%bd%is:Atm%bd%ie,Atm%bd%js:Atm%bd%je)</span>:: &amp;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        id1, id2, jdc</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(Atm%bd%is:Atm%bd%ie+1,Atm%bd%js:Atm%bd%je)</span>::&amp;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        id1_c, id2_c, jdc_c</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(Atm%bd%is:Atm%bd%ie,Atm%bd%js:Atm%bd%je+1)</span>::&amp;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        id1_d, id2_d, jdc_d</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">integer</span>:: i, j, k, im, jm, km, npt</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordtype">integer</span>:: i1, i2, j1, ncid</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">integer</span>:: jbeg, jend</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">integer</span> tsize(3)</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">real(kind=R_GRID)</span>, <span class="keywordtype">dimension(2)</span>:: p1, p2, p3</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">real(kind=R_GRID)</span>, <span class="keywordtype">dimension(3)</span>:: e1, e2, ex, ey</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordtype">logical</span>:: found</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordtype">integer</span> :: is,  ie,  js,  je</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordtype">integer</span> :: isd, ied, jsd, jed</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordtype">integer</span> :: sphum, liq_wat</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">#ifdef MULTI_GASES</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">integer</span> :: spfo, spfo2, spfo3</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">integer</span> :: o3mr</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    is  = atm%bd%is</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    ie  = atm%bd%ie</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    js  = atm%bd%js</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    je  = atm%bd%je</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    isd = atm%bd%isd</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    ied = atm%bd%ied</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    jsd = atm%bd%jsd</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    jed = atm%bd%jed</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    deg2rad = pi/180.</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    fname = <span class="stringliteral">&#39;INPUT/&#39;</span>//atm%flagstruct%res_latlon_dynamics</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">if</span>( file_exist(fname) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesim__nc__mod.html#aba132435cdbc967cae6289d8de91c642">open_ncfile</a>( fname, ncid )        <span class="comment">! open the file</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesim__nc__mod.html#ae7821440ac92334fb40992fd22fb611c">get_ncdim1</a>( ncid, <span class="stringliteral">&#39;lon&#39;</span>,   tsize(1) )</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesim__nc__mod.html#ae7821440ac92334fb40992fd22fb611c">get_ncdim1</a>( ncid, <span class="stringliteral">&#39;lat&#39;</span>,   tsize(2) )</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesim__nc__mod.html#ae7821440ac92334fb40992fd22fb611c">get_ncdim1</a>( ncid, <span class="stringliteral">&#39;lev&#39;</span>, tsize(3) )</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      im = tsize(1); jm = tsize(2); km = tsize(3)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordflow">if</span> (km.ne.npz_in) <span class="keywordflow">then</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">if</span> (is_master()) print *, <span class="stringliteral">&#39;km = &#39;</span>, km</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keyword">call </span>mpp_error(fatal, &amp;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="stringliteral">&#39;==&gt; Error in read_da_inc: km is not equal to npz_in&#39;</span>)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">if</span>(is_master())  <span class="keyword">write</span>(*,*) fname, <span class="stringliteral">&#39; DA increment dimensions:&#39;</span>, tsize</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keyword">allocate</span> (  lon(im) )</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keyword">allocate</span> (  lat(jm) )</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keyword">call </span>_get_var1 (ncid, <span class="stringliteral">&#39;lon&#39;</span>, im, lon )</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keyword">call </span>_get_var1 (ncid, <span class="stringliteral">&#39;lat&#39;</span>, jm, lat )</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="comment">! Convert to radian</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordflow">do</span> i=1,im</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        lon(i) = lon(i) * deg2rad  <span class="comment">! lon(1) = 0.</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordflow">do</span> j=1,jm</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        lat(j) = lat(j) * deg2rad</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keyword">call </span>mpp_error(fatal,<span class="stringliteral">&#39;==&gt; Error in read_da_inc: Expected file &#39;</span>&amp;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          //trim(fname)//<span class="stringliteral">&#39; for DA increment does not exist&#39;</span>)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">! Initialize lat-lon to Cubed bi-linear interpolation coeff:</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacefv__treat__da__inc__mod.html#acab756110e27cca6ad9d1d30e4e33444">remap_coef</a>( is, ie, js, je, isd, ied, jsd, jed, &amp;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        im, jm, lon, lat, id1, id2, jdc, s2c, &amp;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        atm%gridstruct%agrid)</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">! Find bounding latitudes:</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    jbeg = jm-1;         jend = 2</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">do</span> j=js,je</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordflow">do</span> i=is,ie</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          j1 = jdc(i,j)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        jbeg = min(jbeg, j1) </div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        jend = max(jend, j1+1)</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keywordflow">    enddo</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    sphum   = get_tracer_index(model_atmos, <span class="stringliteral">&#39;sphum&#39;</span>)</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">#ifdef MULTI_GASES</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor"></span>    spfo3   = get_tracer_index(model_atmos, <span class="stringliteral">&#39;spfo3&#39;</span>)</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    spfo    = get_tracer_index(model_atmos, <span class="stringliteral">&#39;spfo&#39;</span>)</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    spfo2   = get_tracer_index(model_atmos, <span class="stringliteral">&#39;spfo2&#39;</span>)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="preprocessor"></span>    o3mr    = get_tracer_index(model_atmos, <span class="stringliteral">&#39;o3mr&#39;</span>)</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="preprocessor"></span>    liq_wat = get_tracer_index(model_atmos, <span class="stringliteral">&#39;liq_wat&#39;</span>)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">! perform increments on scalars</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keyword">allocate</span> ( wk3(1:im,jbeg:jend, 1:km) )</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keyword">allocate</span> (  tp(is:ie,js:je,km) )</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keyword">call </span><a class="code" href="fv__treat__da__inc_8F90.html#ae34817d2e98e9054aedcd38fcab5b1d2">apply_inc_on_3d_scalar</a>(<span class="stringliteral">&#39;T_inc&#39;</span>,pt, is_in, js_in, ie_in, je_in)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keyword">call </span><a class="code" href="fv__treat__da__inc_8F90.html#ae34817d2e98e9054aedcd38fcab5b1d2">apply_inc_on_3d_scalar</a>(<span class="stringliteral">&#39;delp_inc&#39;</span>,delp, is_in, js_in, ie_in, je_in)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">if</span> ( .not. atm%flagstruct%hydrostatic ) <span class="keywordflow">then</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keyword">call </span><a class="code" href="fv__treat__da__inc_8F90.html#ae34817d2e98e9054aedcd38fcab5b1d2">apply_inc_on_3d_scalar</a>(<span class="stringliteral">&#39;delz_inc&#39;</span>,delz, isc_in, jsc_in, iec_in, jec_in)</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keywordflow">    endif</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keyword">call </span><a class="code" href="fv__treat__da__inc_8F90.html#ae34817d2e98e9054aedcd38fcab5b1d2">apply_inc_on_3d_scalar</a>(<span class="stringliteral">&#39;sphum_inc&#39;</span>,q(:,:,:,sphum), is_in, js_in, ie_in, je_in)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keyword">call </span><a class="code" href="fv__treat__da__inc_8F90.html#ae34817d2e98e9054aedcd38fcab5b1d2">apply_inc_on_3d_scalar</a>(<span class="stringliteral">&#39;liq_wat_inc&#39;</span>,q(:,:,:,liq_wat), is_in, js_in, ie_in, je_in)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="preprocessor">#ifdef MULTI_GASES</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span><a class="code" href="fv__treat__da__inc_8F90.html#ae34817d2e98e9054aedcd38fcab5b1d2">apply_inc_on_3d_scalar</a>(<span class="stringliteral">&#39;spfo3_inc&#39;</span>,q(:,:,:,spfo3), is_in, js_in, ie_in, je_in)</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keyword">call </span><a class="code" href="fv__treat__da__inc_8F90.html#ae34817d2e98e9054aedcd38fcab5b1d2">apply_inc_on_3d_scalar</a>(<span class="stringliteral">&#39;spfo_inc&#39;</span>,q(:,:,:,spfo), is_in, js_in, ie_in, je_in)</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keyword">call </span><a class="code" href="fv__treat__da__inc_8F90.html#ae34817d2e98e9054aedcd38fcab5b1d2">apply_inc_on_3d_scalar</a>(<span class="stringliteral">&#39;spfo2_inc&#39;</span>,q(:,:,:,spfo2), is_in, js_in, ie_in, je_in)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="preprocessor"></span>    <span class="keyword">call </span><a class="code" href="fv__treat__da__inc_8F90.html#ae34817d2e98e9054aedcd38fcab5b1d2">apply_inc_on_3d_scalar</a>(<span class="stringliteral">&#39;o3mr_inc&#39;</span>,q(:,:,:,o3mr), is_in, js_in, ie_in, je_in)</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keyword">deallocate</span> ( tp )</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keyword">deallocate</span> ( wk3 )</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">! perform increments on winds</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keyword">allocate</span> (pt_c(isd:ied+1,jsd:jed  ,2))</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keyword">allocate</span> (pt_d(isd:ied  ,jsd:jed+1,2))</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keyword">allocate</span> (ud_inc(is:ie  , js:je+1, km))</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keyword">allocate</span> (vd_inc(is:ie+1, js:je  , km))</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacefv__treat__da__inc__mod.html#a603fb0f1b1bda4076d742b12e7cc7cc0">get_staggered_grid</a>( &amp;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        is, ie, js, je, &amp;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        isd, ied, jsd, jed, &amp;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        atm%gridstruct%grid, pt_c, pt_d)</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">!------ pt_c part ------</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">! Initialize lat-lon to Cubed bi-linear interpolation coeff:</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacefv__treat__da__inc__mod.html#acab756110e27cca6ad9d1d30e4e33444">remap_coef</a>( is, ie+1, js, je, isd, ied+1, jsd, jed, &amp;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        im, jm, lon, lat, id1_c, id2_c, jdc_c, s2c_c, &amp;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        pt_c)</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">! Find bounding latitudes:</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    jbeg = jm-1;         jend = 2</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">do</span> j=js,je</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keywordflow">do</span> i=is,ie+1</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          j1 = jdc_c(i,j)</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        jbeg = min(jbeg, j1) </div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        jend = max(jend, j1+1)</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordflow">    enddo</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keyword">allocate</span> ( wk3_u(1:im,jbeg:jend, 1:km) )</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keyword">allocate</span> ( wk3_v(1:im,jbeg:jend, 1:km) )</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keyword">allocate</span> (  u_inc(is:ie+1,js:je,km) )</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keyword">allocate</span> (  v_inc(is:ie+1,js:je,km) )</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacesim__nc__mod.html#aeef43827235a8f2bc87c811ae6f047c0">get_var3_r4</a>( ncid, <span class="stringliteral">&#39;u_inc&#39;</span>, 1,im, jbeg,jend, 1,km, wk3_u )</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacesim__nc__mod.html#aeef43827235a8f2bc87c811ae6f047c0">get_var3_r4</a>( ncid, <span class="stringliteral">&#39;v_inc&#39;</span>, 1,im, jbeg,jend, 1,km, wk3_v )</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">do</span> k=1,km</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordflow">do</span> j=js,je</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordflow">do</span> i=is,ie+1</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;          i1 = id1_c(i,j)</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;          i2 = id2_c(i,j)</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;          j1 = jdc_c(i,j)</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          u_inc(i,j,k) = s2c_c(i,j,1)*wk3_u(i1,j1  ,k) + &amp;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                         s2c_c(i,j,2)*wk3_u(i2,j1  ,k) + &amp;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                         s2c_c(i,j,3)*wk3_u(i2,j1+1,k) + &amp;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                         s2c_c(i,j,4)*wk3_u(i1,j1+1,k)</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          v_inc(i,j,k) = s2c_c(i,j,1)*wk3_v(i1,j1  ,k) + &amp;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                         s2c_c(i,j,2)*wk3_v(i2,j1  ,k) + &amp;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                         s2c_c(i,j,3)*wk3_v(i2,j1+1,k) + &amp;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                         s2c_c(i,j,4)*wk3_v(i1,j1+1,k)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;          p1(:) = atm%gridstruct%grid(i,j  ,1:2)</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;          p2(:) = atm%gridstruct%grid(i,j+1,1:2)</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          <span class="keyword">call  </span><a class="code" href="namespacefv__grid__utils__mod.html#a18ebcb54063bc4dc159f2a87771d4358">mid_pt_sphere</a>(p1, p2, p3)</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacefv__grid__utils__mod.html#a092aabe65224216e6209babe7f15669e">get_unit_vect2</a>(p1, p2, e2)</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacefv__grid__utils__mod.html#a6a6f485efd42e62b7eeb21509b0200cf">get_latlon_vector</a>(p3, ex, ey)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;          vd_inc(i,j,k) = u_inc(i,j,k)*<a class="code" href="namespacefv__grid__utils__mod.html#a9e4bf88962e6eecc388ca075e641d13f">inner_prod</a>(e2,ex) + &amp;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                          v_inc(i,j,k)*<a class="code" href="namespacefv__grid__utils__mod.html#a9e4bf88962e6eecc388ca075e641d13f">inner_prod</a>(e2,ey)</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;          v(i,j,k) = v(i,j,k) + vd_inc(i,j,k)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keywordflow">        enddo</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keywordflow">    enddo</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keyword">deallocate</span> ( u_inc, v_inc )</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keyword">deallocate</span> ( wk3_u, wk3_v )</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">!------ pt_d part ------</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">! Initialize lat-lon to Cubed bi-linear interpolation coeff:</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacefv__treat__da__inc__mod.html#acab756110e27cca6ad9d1d30e4e33444">remap_coef</a>( is, ie, js, je+1, isd, ied, jsd, jed+1, &amp;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        im, jm, lon, lat, id1_d, id2_d, jdc_d, s2c_d, &amp;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        pt_d)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">! Find bounding latitudes:</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    jbeg = jm-1;         jend = 2</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">do</span> j=js,je+1</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">do</span> i=is,ie</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;          j1 = jdc_d(i,j)</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        jbeg = min(jbeg, j1) </div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        jend = max(jend, j1+1)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="keywordflow">    enddo</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keyword">allocate</span> ( wk3_u(1:im,jbeg:jend, 1:km) )</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keyword">allocate</span> ( wk3_v(1:im,jbeg:jend, 1:km) )</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keyword">allocate</span> (  u_inc(is:ie,js:je+1,km) )</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keyword">allocate</span> (  v_inc(is:ie,js:je+1,km) )</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacesim__nc__mod.html#aeef43827235a8f2bc87c811ae6f047c0">get_var3_r4</a>( ncid, <span class="stringliteral">&#39;u_inc&#39;</span>, 1,im, jbeg,jend, 1,km, wk3_u )</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacesim__nc__mod.html#aeef43827235a8f2bc87c811ae6f047c0">get_var3_r4</a>( ncid, <span class="stringliteral">&#39;v_inc&#39;</span>, 1,im, jbeg,jend, 1,km, wk3_v )</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">do</span> k=1,km</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordflow">do</span> j=js,je+1</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">do</span> i=is,ie</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          i1 = id1_d(i,j)</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;          i2 = id2_d(i,j)</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;          j1 = jdc_d(i,j)</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;          u_inc(i,j,k) = s2c_d(i,j,1)*wk3_u(i1,j1  ,k) + &amp;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                         s2c_d(i,j,2)*wk3_u(i2,j1  ,k) + &amp;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                         s2c_d(i,j,3)*wk3_u(i2,j1+1,k) + &amp;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                         s2c_d(i,j,4)*wk3_u(i1,j1+1,k)</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;          v_inc(i,j,k) = s2c_d(i,j,1)*wk3_v(i1,j1  ,k) + &amp;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                         s2c_d(i,j,2)*wk3_v(i2,j1  ,k) + &amp;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                         s2c_d(i,j,3)*wk3_v(i2,j1+1,k) + &amp;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                         s2c_d(i,j,4)*wk3_v(i1,j1+1,k)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;          p1(:) = atm%gridstruct%grid(i,  j,1:2)</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;          p2(:) = atm%gridstruct%grid(i+1,j,1:2)</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;          <span class="keyword">call  </span><a class="code" href="namespacefv__grid__utils__mod.html#a18ebcb54063bc4dc159f2a87771d4358">mid_pt_sphere</a>(p1, p2, p3)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacefv__grid__utils__mod.html#a092aabe65224216e6209babe7f15669e">get_unit_vect2</a>(p1, p2, e1)</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacefv__grid__utils__mod.html#a6a6f485efd42e62b7eeb21509b0200cf">get_latlon_vector</a>(p3, ex, ey)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;          ud_inc(i,j,k) = u_inc(i,j,k)*<a class="code" href="namespacefv__grid__utils__mod.html#a9e4bf88962e6eecc388ca075e641d13f">inner_prod</a>(e1,ex) + &amp;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                          v_inc(i,j,k)*<a class="code" href="namespacefv__grid__utils__mod.html#a9e4bf88962e6eecc388ca075e641d13f">inner_prod</a>(e1,ey)</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          u(i,j,k) = u(i,j,k) + ud_inc(i,j,k)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="keywordflow">        enddo</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="keywordflow">    enddo</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keyword">deallocate</span> ( u_inc, v_inc )</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keyword">deallocate</span> ( wk3_u, wk3_v )</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">!rab The following is not necessary as ua/va will be re-calculated during model startup</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">!rab    call cubed_to_latlon(Atm%u, Atm%v, Atm%ua, Atm%va, &amp;</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">!rab        Atm%gridstruct, Atm%flagstruct%npx, Atm%flagstruct%npy, &amp;</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">!rab        Atm%flagstruct%npz, 1, Atm%gridstruct%grid_type, &amp;</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">!rab        fv_domain, Atm%gridstruct%nested, &amp;</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">!rab        Atm%flagstruct%c2l_ord, Atm%bd)</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">!------ winds clean up ------</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keyword">deallocate</span> ( pt_c, pt_d, ud_inc, vd_inc )</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">!------ all clean up ------</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keyword">deallocate</span> ( lon, lat )</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keyword">contains</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   <span class="comment">!---------------------------------------------------------------------------</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="keyword">    subroutine </span><a class="code" href="fv__treat__da__inc_8F90.html#ae34817d2e98e9054aedcd38fcab5b1d2">apply_inc_on_3d_scalar</a>(field_name,var, is_in, js_in, ie_in, je_in)</div><div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="fv__treat__da__inc_8F90.html#ae34817d2e98e9054aedcd38fcab5b1d2">  436</a></span>&#160;      <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: field_name</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keywordtype">integer</span>, <span class="keywordtype">intent(IN)</span> :: is_in, js_in, ie_in, je_in</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordtype">real</span>, <span class="keywordtype">dimension(is_in:ie_in,js_in:je_in,1:km)</span>, <span class="keywordtype">intent(inout)</span> :: var</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordtype">integer</span> :: ierr</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacesim__nc__mod.html#aa1c1534dbde8d5215e5c8fd8d56473b0">check_var_exists</a>(ncid, field_name, ierr)</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordflow">if</span> (ierr == 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;         <span class="keyword">call </span><a class="code" href="namespacesim__nc__mod.html#aeef43827235a8f2bc87c811ae6f047c0">get_var3_r4</a>( ncid, field_name, 1,im, jbeg,jend, 1,km, wk3 )</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;         <span class="keywordflow">if</span> (is_master()) print *,<span class="stringliteral">&#39;warning: no increment for &#39;</span>,trim(field_name),<span class="stringliteral">&#39; found, assuming zero&#39;</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;         wk3 = 0.</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="keywordflow">do</span> k=1,km</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">do</span> j=js,je</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;          <span class="keywordflow">do</span> i=is,ie</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            i1 = id1(i,j)</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            i2 = id2(i,j)</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            j1 = jdc(i,j)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            tp(i,j,k) = s2c(i,j,1)*wk3(i1,j1  ,k) + s2c(i,j,2)*wk3(i2,j1  ,k)+&amp;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                        s2c(i,j,3)*wk3(i2,j1+1,k) + s2c(i,j,4)*wk3(i1,j1+1,k)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            var(i,j,k) = var(i,j,k)+tp(i,j,k)</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keywordflow">        enddo</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="keyword">    end subroutine </span><a class="code" href="fv__treat__da__inc_8F90.html#ae34817d2e98e9054aedcd38fcab5b1d2">apply_inc_on_3d_scalar</a></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">!---------------------------------------------------------------------------</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keyword">  end subroutine </span><a class="code" href="namespacefv__treat__da__inc__mod.html#a4b6d49f107df211d528692da62142717">read_da_inc</a></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">!=============================================================================</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keyword">  subroutine </span><a class="code" href="namespacefv__treat__da__inc__mod.html#acab756110e27cca6ad9d1d30e4e33444">remap_coef</a>( is, ie, js, je, isd, ied, jsd, jed, &amp;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      im, jm, lon, lat, id1, id2, jdc, s2c, agrid )</div><div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="namespacefv__treat__da__inc__mod.html#acab756110e27cca6ad9d1d30e4e33444">  471</a></span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>:: is, ie, js, je, isd, ied, jsd, jed</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>:: im, jm</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordtype">real</span>,    <span class="keywordtype">intent(in)</span>:: lon(im), lat(jm)</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordtype">real</span>,    <span class="keywordtype">intent(out)</span>:: s2c(is:ie,js:je,4)</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(is:ie,js:je)</span>:: id1, id2, jdc</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordtype">real</span>,    <span class="keywordtype">intent(in)</span>:: agrid(isd:ied,jsd:jed,2)</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">! local:</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordtype">real</span> :: rdlon(im)</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordtype">real</span> :: rdlat(jm)</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordtype">real</span>:: a1, b1</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordtype">integer</span> i,j, i1, i2, jc, i0, j0</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">do</span> i=1,im-1</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      rdlon(i) = 1. / (lon(i+1) - lon(i))</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="keywordflow">    enddo</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    rdlon(im) = 1. / (lon(1) + 2.*pi - lon(im))</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">do</span> j=1,jm-1</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      rdlat(j) = 1. / (lat(j+1) - lat(j))</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keywordflow">    enddo</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">! * Interpolate to cubed sphere cell center</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">do</span> 5000 j=js,je</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">do</span> i=is,ie</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">if</span> ( agrid(i,j,1)&gt;lon(im) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;          i1 = im;     i2 = 1</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;          a1 = (agrid(i,j,1)-lon(im)) * rdlon(im)</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">elseif</span> ( agrid(i,j,1)&lt;lon(1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;          i1 = im;     i2 = 1</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;          a1 = (agrid(i,j,1)+2.*pi-lon(im)) * rdlon(im)</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;          <span class="keywordflow">do</span> i0=1,im-1</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <span class="keywordflow">if</span> ( agrid(i,j,1)&gt;=lon(i0) .and. agrid(i,j,1)&lt;=lon(i0+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;              i1 = i0;  i2 = i0+1</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;              a1 = (agrid(i,j,1)-lon(i1)) * rdlon(i0)</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;              <span class="keywordflow">go to</span> 111</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;111     <span class="keywordflow">continue</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">if</span> ( agrid(i,j,2)&lt;lat(1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;          jc = 1</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;          b1 = 0.</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">elseif</span> ( agrid(i,j,2)&gt;lat(jm) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;          jc = jm-1</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;          b1 = 1.</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;          <span class="keywordflow">do</span> j0=1,jm-1</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordflow">if</span> ( agrid(i,j,2)&gt;=lat(j0) .and. agrid(i,j,2)&lt;=lat(j0+1) ) <span class="keywordflow">then</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;              jc = j0</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;              b1 = (agrid(i,j,2)-lat(jc)) * rdlat(jc)</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;              <span class="keywordflow">go to</span> 222</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="keywordflow">            endif</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keywordflow">          enddo</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;222     <span class="keywordflow">continue</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="keywordflow">if</span> ( a1&lt;0.0 .or. a1&gt;1.0 .or.  b1&lt;0.0 .or. b1&gt;1.0 ) <span class="keywordflow">then</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;             <span class="keyword">write</span>(*,*) <span class="stringliteral">&#39;gid=&#39;</span>, mpp_pe(), i,j,a1, b1</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        s2c(i,j,1) = (1.-a1) * (1.-b1)</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        s2c(i,j,2) =     a1  * (1.-b1)</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        s2c(i,j,3) =     a1  *     b1</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        s2c(i,j,4) = (1.-a1) *     b1</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        id1(i,j) = i1</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        id2(i,j) = i2</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        jdc(i,j) = jc</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="keywordflow">      enddo</span>   <span class="comment">!i-loop</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;5000 <span class="keywordflow">continue</span>   <span class="comment">! j-loop</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="keyword">  end subroutine </span><a class="code" href="namespacefv__treat__da__inc__mod.html#acab756110e27cca6ad9d1d30e4e33444">remap_coef</a></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="comment">!=============================================================================</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="keyword">  subroutine </span><a class="code" href="namespacefv__treat__da__inc__mod.html#a603fb0f1b1bda4076d742b12e7cc7cc0">get_staggered_grid</a>( &amp;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      is, ie, js, je, &amp;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      isd, ied, jsd, jed, &amp;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      pt_b, pt_c, pt_d)</div><div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="namespacefv__treat__da__inc__mod.html#a603fb0f1b1bda4076d742b12e7cc7cc0">  554</a></span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: is, ie, js, je, isd, ied, jsd, jed</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordtype">real</span>, <span class="keywordtype">dimension(isd:ied+1,jsd:jed+1,2)</span>, <span class="keywordtype">intent(in)</span> :: pt_b</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordtype">real</span>, <span class="keywordtype">dimension(isd:ied+1,jsd:jed  ,2)</span>, <span class="keywordtype">intent(out)</span> :: pt_c</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordtype">real</span>, <span class="keywordtype">dimension(isd:ied  ,jsd:jed+1,2)</span>, <span class="keywordtype">intent(out)</span> :: pt_d</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">! local</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordtype">real(kind=R_GRID)</span>, <span class="keywordtype">dimension(2)</span>:: p1, p2, p3</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordtype">integer</span> :: i, j</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">do</span> j = js,je+1</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="keywordflow">do</span> i = is,ie</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        p1(:) = pt_b(i,  j,1:2)</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        p2(:) = pt_b(i+1,j,1:2)</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keyword">call  </span><a class="code" href="namespacefv__grid__utils__mod.html#a18ebcb54063bc4dc159f2a87771d4358">mid_pt_sphere</a>(p1, p2, p3)</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        pt_d(i,j,1:2) = p3(:)</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="keywordflow">    enddo</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">do</span> j = js,je</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordflow">do</span> i = is,ie+1</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        p1(:) = pt_b(i,j  ,1:2)</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        p2(:) = pt_b(i,j+1,1:2)</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="keyword">call  </span><a class="code" href="namespacefv__grid__utils__mod.html#a18ebcb54063bc4dc159f2a87771d4358">mid_pt_sphere</a>(p1, p2, p3)</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        pt_c(i,j,1:2) = p3(:)</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="keywordflow">      enddo</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="keywordflow">    enddo</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="keyword">  end subroutine </span><a class="code" href="namespacefv__treat__da__inc__mod.html#a603fb0f1b1bda4076d742b12e7cc7cc0">get_staggered_grid</a></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="comment">!=============================================================================</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="keyword">end module </span><a class="code" href="namespacefv__treat__da__inc__mod.html">fv_treat_da_inc_mod</a></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="ttc" id="namespacefv__grid__utils__mod_html_a18ebcb54063bc4dc159f2a87771d4358"><div class="ttname"><a href="namespacefv__grid__utils__mod.html#a18ebcb54063bc4dc159f2a87771d4358">fv_grid_utils_mod::mid_pt_sphere</a></div><div class="ttdeci">subroutine, public mid_pt_sphere(p1, p2, pm)</div><div class="ttdef"><b>Definition:</b> <a href="fv__grid__utils_8F90_source.html#l02020">fv_grid_utils.F90:2020</a></div></div>
<div class="ttc" id="namespacesim__nc__mod_html_aeef43827235a8f2bc87c811ae6f047c0"><div class="ttname"><a href="namespacesim__nc__mod.html#aeef43827235a8f2bc87c811ae6f047c0">sim_nc_mod::get_var3_r4</a></div><div class="ttdeci">subroutine, public get_var3_r4(ncid, var3_name, is, ie, js, je, ks, ke, var3, time_slice)</div><div class="ttdef"><b>Definition:</b> <a href="sim__nc__mod_8F90_source.html#l00246">sim_nc_mod.F90:246</a></div></div>
<div class="ttc" id="namespacefv__mp__mod_html"><div class="ttname"><a href="namespacefv__mp__mod.html">fv_mp_mod</a></div><div class="ttdoc">The module &amp;#39;fv_mp_mod&amp;#39; is a single program multiple data (SPMD) parallel decompostion/communication m...</div><div class="ttdef"><b>Definition:</b> <a href="fv__mp__mod_8F90_source.html#l00024">fv_mp_mod.F90:24</a></div></div>
<div class="ttc" id="structfv__arrays__mod_1_1fv__grid__type_html"><div class="ttname"><a href="structfv__arrays__mod_1_1fv__grid__type.html">fv_arrays_mod::fv_grid_type</a></div><div class="ttdoc">The type &amp;#39;fv_grid_type&amp;#39; is made up of grid-dependent information from fv_grid_tools and fv_grid_utils...</div><div class="ttdef"><b>Definition:</b> <a href="fv__arrays_8F90_source.html#l00123">fv_arrays.F90:123</a></div></div>
<div class="ttc" id="structfv__arrays__mod_1_1fv__grid__bounds__type_html"><div class="ttname"><a href="structfv__arrays__mod_1_1fv__grid__bounds__type.html">fv_arrays_mod::fv_grid_bounds_type</a></div><div class="ttdef"><b>Definition:</b> <a href="fv__arrays_8F90_source.html#l01187">fv_arrays.F90:1187</a></div></div>
<div class="ttc" id="namespacefv__grid__utils__mod_html_acf53e76b1bc9e689efe4900919cd05ef"><div class="ttname"><a href="namespacefv__grid__utils__mod.html#acf53e76b1bc9e689efe4900919cd05ef">fv_grid_utils_mod::g_sum</a></div><div class="ttdeci">real function, public g_sum(domain, p, ifirst, ilast, jfirst, jlast, ngc, area, mode, reproduce)</div><div class="ttdoc">The function &amp;#39;g_sum&amp;#39; is the fast version of &amp;#39;globalsum&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="fv__grid__utils_8F90_source.html#l02968">fv_grid_utils.F90:2968</a></div></div>
<div class="ttc" id="namespacefv__grid__utils__mod_html_a9e4bf88962e6eecc388ca075e641d13f"><div class="ttname"><a href="namespacefv__grid__utils__mod.html#a9e4bf88962e6eecc388ca075e641d13f">fv_grid_utils_mod::inner_prod</a></div><div class="ttdeci">real function, public inner_prod(v1, v2)</div><div class="ttdef"><b>Definition:</b> <a href="fv__grid__utils_8F90_source.html#l01039">fv_grid_utils.F90:1039</a></div></div>
<div class="ttc" id="namespacefv__grid__utils__mod_html_a6a6f485efd42e62b7eeb21509b0200cf"><div class="ttname"><a href="namespacefv__grid__utils__mod.html#a6a6f485efd42e62b7eeb21509b0200cf">fv_grid_utils_mod::get_latlon_vector</a></div><div class="ttdeci">subroutine, public get_latlon_vector(pp, elon, elat)</div><div class="ttdef"><b>Definition:</b> <a href="fv__grid__utils_8F90_source.html#l03341">fv_grid_utils.F90:3341</a></div></div>
<div class="ttc" id="namespacefv__grid__utils__mod_html_a092aabe65224216e6209babe7f15669e"><div class="ttname"><a href="namespacefv__grid__utils__mod.html#a092aabe65224216e6209babe7f15669e">fv_grid_utils_mod::get_unit_vect2</a></div><div class="ttdeci">subroutine, public get_unit_vect2(e1, e2, uc)</div><div class="ttdef"><b>Definition:</b> <a href="fv__grid__utils_8F90_source.html#l01887">fv_grid_utils.F90:1887</a></div></div>
<div class="ttc" id="namespacefv__arrays__mod_html_ab0ba8527d270f349a84fa0a330be1923"><div class="ttname"><a href="namespacefv__arrays__mod.html#ab0ba8527d270f349a84fa0a330be1923">fv_arrays_mod::r_grid</a></div><div class="ttdeci">integer, parameter, public r_grid</div><div class="ttdef"><b>Definition:</b> <a href="fv__arrays_8F90_source.html#l00034">fv_arrays.F90:34</a></div></div>
<div class="ttc" id="namespacefv__treat__da__inc__mod_html_a4b6d49f107df211d528692da62142717"><div class="ttname"><a href="namespacefv__treat__da__inc__mod.html#a4b6d49f107df211d528692da62142717">fv_treat_da_inc_mod::read_da_inc</a></div><div class="ttdeci">subroutine, public read_da_inc(Atm, fv_domain, bd, npz_in, nq, u, v, q, delp, pt, delz, is_in, js_in, ie_in, je_in, isc_in, jsc_in, iec_in, jec_in)</div><div class="ttdoc">The subroutine &amp;#39;read_da_inc&amp;#39; reads the increments of the diagnostic variables from the DA-generated f...</div><div class="ttdef"><b>Definition:</b> <a href="fv__treat__da__inc_8F90_source.html#l00160">fv_treat_da_inc.F90:160</a></div></div>
<div class="ttc" id="namespacesim__nc__mod_html_accbb162bf22e5a5d2b9de65c8db7b3f1"><div class="ttname"><a href="namespacesim__nc__mod.html#accbb162bf22e5a5d2b9de65c8db7b3f1">sim_nc_mod::get_var1_real</a></div><div class="ttdeci">subroutine, public get_var1_real(ncid, var1_name, im, var1, var_exist)</div><div class="ttdef"><b>Definition:</b> <a href="sim__nc__mod_8F90_source.html#l00116">sim_nc_mod.F90:116</a></div></div>
<div class="ttc" id="fv__treat__da__inc_8F90_html_ae34817d2e98e9054aedcd38fcab5b1d2"><div class="ttname"><a href="fv__treat__da__inc_8F90.html#ae34817d2e98e9054aedcd38fcab5b1d2">apply_inc_on_3d_scalar</a></div><div class="ttdeci">subroutine apply_inc_on_3d_scalar(field_name, var, is_in, js_in, ie_in, je_in)</div><div class="ttdoc">The subroutine &amp;#39;apply_inc_on3d_scalar&amp;#39; applies the input increments to the prognostic variables...</div><div class="ttdef"><b>Definition:</b> <a href="fv__treat__da__inc_8F90_source.html#l00436">fv_treat_da_inc.F90:436</a></div></div>
<div class="ttc" id="namespacesim__nc__mod_html_ace9b6fd17d5ca314e8ad1cd4dfbeac4b"><div class="ttname"><a href="namespacesim__nc__mod.html#ace9b6fd17d5ca314e8ad1cd4dfbeac4b">sim_nc_mod::get_var1_double</a></div><div class="ttdeci">subroutine, public get_var1_double(ncid, var1_name, im, var1, var_exist)</div><div class="ttdoc">The &amp;#39;get_var&amp;#39; subroutines read in variables from netcdf files. </div><div class="ttdef"><b>Definition:</b> <a href="sim__nc__mod_8F90_source.html#l00093">sim_nc_mod.F90:93</a></div></div>
<div class="ttc" id="namespacefv__grid__utils__mod_html_a8363bc8f261396e37744efbbfa91fb7d"><div class="ttname"><a href="namespacefv__grid__utils__mod.html#a8363bc8f261396e37744efbbfa91fb7d">fv_grid_utils_mod::ptop_min</a></div><div class="ttdeci">real, parameter, public ptop_min</div><div class="ttdef"><b>Definition:</b> <a href="fv__grid__utils_8F90_source.html#l00109">fv_grid_utils.F90:109</a></div></div>
<div class="ttc" id="namespacefv__grid__utils__mod_html_a7350d132e32d908f113d772b833eab8a"><div class="ttname"><a href="namespacefv__grid__utils__mod.html#a7350d132e32d908f113d772b833eab8a">fv_grid_utils_mod::cubed_to_latlon</a></div><div class="ttdeci">subroutine, public cubed_to_latlon(u, v, ua, va, gridstruct, npx, npy, km, mode, grid_type, domain, bounded_domain, c2l_ord, bd)</div><div class="ttdef"><b>Definition:</b> <a href="fv__grid__utils_8F90_source.html#l02412">fv_grid_utils.F90:2412</a></div></div>
<div class="ttc" id="namespacefv__arrays__mod_html"><div class="ttname"><a href="namespacefv__arrays__mod.html">fv_arrays_mod</a></div><div class="ttdoc">The module &amp;#39;fv_arrays&amp;#39; contains the &amp;#39;fv_atmos_type&amp;#39; and associated datatypes. </div><div class="ttdef"><b>Definition:</b> <a href="fv__arrays_8F90_source.html#l00024">fv_arrays.F90:24</a></div></div>
<div class="ttc" id="namespacesim__nc__mod_html"><div class="ttname"><a href="namespacesim__nc__mod.html">sim_nc_mod</a></div><div class="ttdoc">The module &amp;#39;sim_nc&amp;#39; is a netcdf file reader. </div><div class="ttdef"><b>Definition:</b> <a href="sim__nc__mod_8F90_source.html#l00028">sim_nc_mod.F90:28</a></div></div>
<div class="ttc" id="namespacesim__nc__mod_html_a0d037f885e13796e5464178753a4f7c0"><div class="ttname"><a href="namespacesim__nc__mod.html#a0d037f885e13796e5464178753a4f7c0">sim_nc_mod::get_var2_real</a></div><div class="ttdeci">subroutine, public get_var2_real(ncid, var_name, im, jm, var2)</div><div class="ttdef"><b>Definition:</b> <a href="sim__nc__mod_8F90_source.html#l00137">sim_nc_mod.F90:137</a></div></div>
<div class="ttc" id="namespacefv__treat__da__inc__mod_html"><div class="ttname"><a href="namespacefv__treat__da__inc__mod.html">fv_treat_da_inc_mod</a></div><div class="ttdoc">&amp;#39;The module &amp;#39;tread_da_increment&amp;#39; contains routines for treating the increments of the prognostic vari...</div><div class="ttdef"><b>Definition:</b> <a href="fv__treat__da__inc_8F90_source.html#l00046">fv_treat_da_inc.F90:46</a></div></div>
<div class="ttc" id="namespacesim__nc__mod_html_aba132435cdbc967cae6289d8de91c642"><div class="ttname"><a href="namespacesim__nc__mod.html#aba132435cdbc967cae6289d8de91c642">sim_nc_mod::open_ncfile</a></div><div class="ttdeci">subroutine, public open_ncfile(iflnm, ncid)</div><div class="ttdef"><b>Definition:</b> <a href="sim__nc__mod_8F90_source.html#l00055">sim_nc_mod.F90:55</a></div></div>
<div class="ttc" id="namespacefv__treat__da__inc__mod_html_a603fb0f1b1bda4076d742b12e7cc7cc0"><div class="ttname"><a href="namespacefv__treat__da__inc__mod.html#a603fb0f1b1bda4076d742b12e7cc7cc0">fv_treat_da_inc_mod::get_staggered_grid</a></div><div class="ttdeci">subroutine get_staggered_grid(is, ie, js, je, isd, ied, jsd, jed, pt_b, pt_c, pt_d)</div><div class="ttdoc">The subroutine &amp;#39;get_staggered_grid&amp;#39; gets the lat-lon locations of the staggered points. </div><div class="ttdef"><b>Definition:</b> <a href="fv__treat__da__inc_8F90_source.html#l00554">fv_treat_da_inc.F90:554</a></div></div>
<div class="ttc" id="namespacefv__grid__utils__mod_html"><div class="ttname"><a href="namespacefv__grid__utils__mod.html">fv_grid_utils_mod</a></div><div class="ttdoc">The module &amp;#39;fv_grid_utils&amp;#39; contains routines for setting up and computing grid-related quantities...</div><div class="ttdef"><b>Definition:</b> <a href="fv__grid__utils_8F90_source.html#l00026">fv_grid_utils.F90:26</a></div></div>
<div class="ttc" id="structfv__arrays__mod_1_1fv__atmos__type_html"><div class="ttname"><a href="structfv__arrays__mod_1_1fv__atmos__type.html">fv_arrays_mod::fv_atmos_type</a></div><div class="ttdef"><b>Definition:</b> <a href="fv__arrays_8F90_source.html#l01216">fv_arrays.F90:1216</a></div></div>
<div class="ttc" id="namespacefv__treat__da__inc__mod_html_acab756110e27cca6ad9d1d30e4e33444"><div class="ttname"><a href="namespacefv__treat__da__inc__mod.html#acab756110e27cca6ad9d1d30e4e33444">fv_treat_da_inc_mod::remap_coef</a></div><div class="ttdeci">subroutine, public remap_coef(is, ie, js, je, isd, ied, jsd, jed, im, jm, lon, lat, id1, id2, jdc, s2c, agrid)</div><div class="ttdoc">The subroutine &amp;#39;remap_coef&amp;#39; calculates the coefficients for horizonal regridding. ...</div><div class="ttdef"><b>Definition:</b> <a href="fv__treat__da__inc_8F90_source.html#l00471">fv_treat_da_inc.F90:471</a></div></div>
<div class="ttc" id="namespacesim__nc__mod_html_ae7821440ac92334fb40992fd22fb611c"><div class="ttname"><a href="namespacesim__nc__mod.html#ae7821440ac92334fb40992fd22fb611c">sim_nc_mod::get_ncdim1</a></div><div class="ttdeci">subroutine, public get_ncdim1(ncid, var1_name, im)</div><div class="ttdef"><b>Definition:</b> <a href="sim__nc__mod_8F90_source.html#l00078">sim_nc_mod.F90:78</a></div></div>
<div class="ttc" id="namespacesim__nc__mod_html_aa1c1534dbde8d5215e5c8fd8d56473b0"><div class="ttname"><a href="namespacesim__nc__mod.html#aa1c1534dbde8d5215e5c8fd8d56473b0">sim_nc_mod::check_var_exists</a></div><div class="ttdeci">subroutine, public check_var_exists(ncid, var_name, status)</div><div class="ttdef"><b>Definition:</b> <a href="sim__nc__mod_8F90_source.html#l00238">sim_nc_mod.F90:238</a></div></div>
<div class="ttc" id="namespacesim__nc__mod_html_a0723aaca20b4f506ff134f191c9c2773"><div class="ttname"><a href="namespacesim__nc__mod.html#a0723aaca20b4f506ff134f191c9c2773">sim_nc_mod::close_ncfile</a></div><div class="ttdeci">subroutine, public close_ncfile(ncid)</div><div class="ttdef"><b>Definition:</b> <a href="sim__nc__mod_8F90_source.html#l00067">sim_nc_mod.F90:67</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_4eeb864c4eec08c7d6b9d3b0352cfdde.html">tools</a></li><li class="navelem"><a class="el" href="fv__treat__da__inc_8F90.html">fv_treat_da_inc.F90</a></li>
    <li class="footer">Generated on Wed Feb 24 2021 08:04:36 for FV3DYCORE by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
