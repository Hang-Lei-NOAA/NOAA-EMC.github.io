<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FV3DYCORE DOCUMENTATION: GFS Orographic Gravity Wave Drag and Mountain Blocking</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FV3DYCORE DOCUMENTATION
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__GFS__ogwd.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">GFS Orographic Gravity Wave Drag and Mountain Blocking<div class="ingroups"><a class="el" href="group__GFS__gwd.html">GFS Orographic Gravity Wave Drag</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This subroutine includes orographic gravity wave drag and mountain blocking.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ga82eda62e1bdee0a0ab6a831fc53ae89c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GFS__ogwd.html#ga82eda62e1bdee0a0ab6a831fc53ae89c">gwdps</a> (IM, IX, IY, KM, A, B, C, U1, V1, T1, Q1, KPBL, PRSI, DEL, PRSL, PRSLK, PHII, PHIL, DELTIM, KDT, HPRIME, OC, OA4, CLX4, THETA, SIGMA, GAMMA, ELVMAX, DUSFC, DVSFC, G, CP, RD, RV, IMX, nmtvr, cdmbgwd, me, lprnt, ipr, rdxzb)</td></tr>
<tr class="separator:ga82eda62e1bdee0a0ab6a831fc53ae89c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This subroutine includes orographic gravity wave drag and mountain blocking. </p>
<p>The time tendencies of zonal and meridional wind are altered to include the effect of mountain induced gravity wave drag from subgrid scale orography including convective breaking, shear breaking and the presence of critical levels.</p>
<p>The NWP model gravity wave drag (GWD) scheme in the GFS has two main components: how the surface stress is computed, and then how that stress is distributed over a vertical column where it may interact with the models momentum. Each of these depends on the large scale environmental atmospheric state and assumptions about the sub-grid scale processes. In Alpert GWD (1987) based on linear, two-dimensional non-rotating, stably stratified flow over a mountain ridge, sub-grid scale gravity wave motions are assumed which propagate away from the mountain. Described in Alpert (1987), the flux measured over a "low level" vertically averaged layer, in the atmosphere defines a base level flux. "Low level" was taken to be the first 1/3 of the troposphere in the 1987 implementation. This choice was meant to encompass a thick low layer for vertical averages of the environmental (large scale) flow quantities. The vertical momentum flux or gravity wave stress in a grid box due to a single mountain is given as in Pierrehumbert, (1987) (PH):</p>
<p>\( \tau = \frac {\rho \: U^{3}\: G(F_{r})} {\Delta X \; N } \)</p>
<p>emetic \( \Delta X \) is a grid increment, N is the Brunt Viasala frequency</p>
<p>\( N(\sigma) = \frac{-g \: \sigma \: \frac{\partial\Theta}{\partial\sigma}}{\Theta \:R \:T} \)</p>
<p>The environmental variables are calculated from a mass weighted vertical average over a base layer. G(Fr) is a monotonically increasing function of Froude number,</p>
<p>\( F_{r} = \frac{N h^{&#39;}}{U} \)</p>
<p>where U is the wind speed calculated as a mass weighted vertical average in the base layer, and h', is the vertical displacement caused by the orography variance. An effective mountain length for the gravity wave processes,</p>
<p>\( l^{*} = \frac{\Delta X}{m} \)</p>
<p>where m is the number of mountains in a grid box, can then be defined to obtain the form of the base level stress</p>
<p>\( \tau = \frac {\rho \: U^{3} \: G(F_{r})} {N \;l^{*}} \)</p>
<p>giving the stress induced from the surface in a model grid box. PH gives the form for the function G(Fr) as</p>
<p>\( G(F_{r}) = \bar{G}\frac{F^{2}_{r}}{F^{2}_{r}\: + \:a^{2}} \)</p>
<p>Where \( \bar{G} \) is an order unity non-dimensional saturation flux set to 1 and 'a' is a function of the mountain aspect ratio also set to 1 in the 1987 implementation of the GFS GWD. Typical values of U=10m/s, N=0.01 1/s, l*=100km, and a=1, gives a flux of 1 Pascal and if this flux is made to go to zero linearly with height then the decelerations would be about 10/m/s/day which is consistent with observations in PH.</p>
<p>In Kim, Moorthi, Alpert's (1998, 2001) GWD currently in GFS operations, the GWD scheme has the same physical basis as in Alpert (1987) with the addition of enhancement factors for the amplitude, G, and mountain shape details in G(Fr) to account for effects from the mountain blocking. A factor, E m’, is an enhancement factor on the stress in the Alpert '87 scheme. The E ranges from no enhancement to an upper limit of 3, E=E(OA)[1-3], and is a function of OA, the Orographic Asymmetry defined in KA (1995) as</p>
<p>Orographic Asymmetry (OA) = \( \frac{ \bar{x} \; - \; \sum\limits_{j=1}^{N_{b}} x_{j} \; n_{j} }{\sigma_{x}} \)</p>
<p>where Nb is the total number of bottom blocks in the mountain barrier, \( \sigma_{x} \) is the standard deviation of the horizontal distance defined by</p>
<p>\( \sigma_{x} = \sqrt{ \frac{\sum\limits_{j=1}^{N_{b}} \; (x_{j} \; - \; \bar{x} )^2}{N_{x}} } \)</p>
<p>where Nx is the number of grid intervals for the large scale domain being considered. So the term, E(OA)m’/ \( \Delta X \) in Kim's scheme represents a multiplier on G shown in Alpert's eq (1), where m’ is the number of mountains in a sub-grid scale box. Kim increased the complexity of m’ making it a function of the fractional area of the sub-grid mountain and the asymmetry and convexity statistics which are found from running a gravity wave model for a large number of cases:</p>
<p>\( m^{&#39;} = C_{m} \Delta X \left[ \frac{1 \; + \; \sum\limits_{x} L_{h} }{\Delta X} \right]^{OA+1} \)</p>
<p>Where, according to Kim, \( \sum \frac{L_{h}}{\Delta X} \) is the fractional area covered by the subgrid-scale orography higher than a critical height \( h_{c} = Fr_{c} U_{0}/N_{0} \) , over the "low level" vertically averaged layer, for a grid box with the interval \( \Delta X \). Each \( L_{n}\) is the width of a segment of orography intersection at the critical height:</p>
<p>\( Fr_{0} = \frac{N_{0} \; h^{&#39;}}{U_{0}} \)</p>
<p>\( G^{&#39;}(OC,Fr_{0}) = \frac{Fr_{0}^{2}}{Fr_{0}^{2} \; + \; a^{2}} \)</p>
<p>\( a^{2} = \frac{C_{G}}{OC} \)</p>
<p>\( E(OA, Fr_{0}) = (OA \; + \; 2)^{\delta} \) and \( \delta \; = \; \frac{C_{E} \; Fr_{0}}{Fr_{c}} \) where \( Fr_{c} \) is as in Alpert.</p>
<p>This represents a closed scheme, somewhat empirical adjustments to the original scheme to calculate the surface stress.</p>
<p>Momentum is deposited by the sub-grid scale gravity waves break due to the presence of convective mixing assumed to occur when the minimum Richardson number:</p>
<p>Orographic Convexity (OC) = \( \frac{ \sum\limits_{j=1}^{N_{x}} \; (h_{j} \; - \; \bar{h})^4 }{N_{x} \;\sigma_{h}^4} \) , and where \( \sigma_{h} = \sqrt{ \frac{\sum\limits_{j=1}^{N_{x}} \; (h_{j} \; - \; \bar{h} )^2}{N_{x}} } \)</p>
<p>This represents a closed scheme, somewhat empirical adjustments to the original scheme to calculate the surface stress.</p>
<p>Momentum is deposited by the sub-grid scale gravity waves break due to the presence of convective mixing assumed to occur when the minimum Richardson number:</p>
<p>\( Ri_{m} = \frac{Ri(1 \; - \; Fr)}{(1 \; + \; \sqrt{Ri}Fr)^2} \)</p>
<p>Is less than 1/4 Or if critical layers are encountered in a layer the the momentum flux will vanish. The critical layer is defined when the base layer wind becomes perpendicular to the environmental wind. Otherwise, wave breaking occurs at a level where the amplification of the wave causes the local Froude number or similarly a truncated (first term of the) Scorer parameter, to be reduced below a critical value by the saturation hypothesis (Lindzen,). This is done through eq 1 which can be written as</p>
<p>\( \tau = \rho U N k h^{&#39;2} \)</p>
<p>For small Froude number this is discretized in the vertical so at each level the stress is reduced by ratio of the Froude or truncated Scorer parameter, \( \frac{U^{2}}{N^{2}} = \frac{N \tau_{l-1}}{\rho U^{3} k} \) , where the stress is from the layer below beginning with that found near the surface. The respective change in momentum is applied in that layer building up from below.</p>
<p>An amplitude factor is part of the calibration of this scheme which is a function of the model resolution and the vertical diffusion. This is because the vertical diffusion and the GWD account encompass similar physical processes. Thus, one needs to run the model over and over for various amplitude factors for GWD and vertical diffusion.</p>
<p>In addition, there is also mountain blocking from lift and frictional forces. Improved integration between how the GWD is calculated and the mountain blocking of wind flow around sub-grid scale orography is underway at NCEP. The GFS already has convectively forced GWD an independent process. The next step is to test</p>
<h1><a class="anchor" id="arg_table_gwdps_run"></a>
Arguments</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">local var name  </th><th class="markdownTableHeadNone">longname  </th><th class="markdownTableHeadNone">description  </th><th class="markdownTableHeadNone">units  </th><th class="markdownTableHeadNone">rank  </th><th class="markdownTableHeadNone">type  </th><th class="markdownTableHeadNone">kind  </th><th class="markdownTableHeadNone">intent  </th><th class="markdownTableHeadNone">optional   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">im  </td><td class="markdownTableBodyNone">horizontal_loop_extent  </td><td class="markdownTableBodyNone">horizontal loop extent, start at 1  </td><td class="markdownTableBodyNone">index  </td><td class="markdownTableBodyNone">0  </td><td class="markdownTableBodyNone">integer  </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">in  </td><td class="markdownTableBodyNone">F   </td></tr>
</table>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">IM</td><td>horizontal number of used pts </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IX</td><td>horizontal dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IY</td><td>horizontal number of used pts </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">KM</td><td>vertical layer dimension </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">A</td><td>non-linear tendency for v wind component </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">B</td><td>non-linear tendency for u wind component </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">C</td><td>non-linear tendency for temperature (not used) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">U1</td><td>zonal wind component of model layer wind (m/s) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">V1</td><td>meridional wind component of model layer wind (m/s) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">T1</td><td>model layer mean temperature (K) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Q1</td><td>model layer mean specific humidity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">KPBL</td><td>index for the PBL top layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PRSI</td><td>pressure at layer interfaces </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DEL</td><td>positive increment of p/psfc across layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PRSL</td><td>mean layer pressure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PRSLK</td><td>Exner function at layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PHII</td><td>interface geopotential ( \(m^2/s^2\)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PHIL</td><td>layer geopotential ( \(m^2/s^2\)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DELTIM</td><td>physics time step in seconds </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">KDT</td><td>number of the current time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">HPRIME</td><td>orographic standard deviation (m) (mtnvar(:,1)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">OC</td><td>orographic Convexity (mtnvar(:,2)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">OA4</td><td>orographic Asymmetry (mtnvar(:,3:6)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CLX4</td><td>Lx, the fractional area covered by the subgrid-scale orography higher than a critical height for a grid box with the interval \( \triangle x \) (mtnvar(:,7:10)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">THETA</td><td>the angle of the mtn with that to the east (x) axis (mtnvar(:,11)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SIGMA</td><td>orographic slope (mtnvar(:,13)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">GAMMA</td><td>orographic anisotropy (mtnvar(:,12)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ELVMAX</td><td>orographic maximum (mtnvar(:,14)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">DUSFC</td><td>u component of surface stress </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">DVSFC</td><td>v component of surface stress </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">G</td><td>see physcons::con_g </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CP</td><td>see physcons::con_cp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">RD</td><td>see physcons::con_tird </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">RV</td><td>see physcons::con_rv </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IMX</td><td>number of longitude points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NMTVR</td><td>number of topographic variables such as variance etc used in the GWD parameterization,current operational, nmtvr=14 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CDMBGWD</td><td>multiplication factors for cdmb and gwd </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ME</td><td>pe number - used for debug prints </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LPRNT</td><td>logical print flag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IPR</td><td>check print point for debugging </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="gen_gwdps"></a>
General Algorithm</h1>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ga82eda62e1bdee0a0ab6a831fc53ae89c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga82eda62e1bdee0a0ab6a831fc53ae89c">&#9670;&nbsp;</a></span>gwdps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwdps </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>KM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(iy,km)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(iy,km)&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(iy,km)&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>U1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>T1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>Q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(im)&#160;</td>
          <td class="paramname"><em>KPBL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km+1)&#160;</td>
          <td class="paramname"><em>PRSI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>DEL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>PRSL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>PRSLK</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km+1)&#160;</td>
          <td class="paramname"><em>PHII</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>PHIL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys)&#160;</td>
          <td class="paramname"><em>DELTIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>KDT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>HPRIME</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>OC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(iy,4)&#160;</td>
          <td class="paramname"><em>OA4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(iy,4)&#160;</td>
          <td class="paramname"><em>CLX4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>THETA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>SIGMA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>GAMMA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>ELVMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>DUSFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>DVSFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys)&#160;</td>
          <td class="paramname"><em>CP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys)&#160;</td>
          <td class="paramname"><em>RD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys)&#160;</td>
          <td class="paramname"><em>RV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IMX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nmtvr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(2)&#160;</td>
          <td class="paramname"><em>cdmbgwd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>lprnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ipr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(iy)&#160;</td>
          <td class="paramname"><em>rdxzb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>&mdash; Subgrid Mountain Blocking Section</p>
<ul>
<li>Compute Brunt-Vaisala Frequency \(N\).</li>
<li>Find the dividing streamline height starting from the level above the maximum mountain height and processing downward.</li>
<li>Compute wind speed UDS <p class="formulaDsp">
\[ UDS=\max(\sqrt{U1^2+V1^2},minwnd) \]
</p>
 where \( minwnd=0.1 \), \(U1\) and \(V1\) are zonal and meridional wind components of model layer wind.</li>
<li>The dividing streamline height (idxzb), of a subgrid scale obstable, is found by comparing the potential (PE) and kinetic energies (EK) of the upstream large scale wind and subgrid scale air parcel movements. the dividing streamline is found when \(PE\geq EK\). Mountain-blocked flow is defined to exist between the surface and the dividing streamline height ( \(h_d\)), which can be found by solving an integral equation for \(h_d\): <p class="formulaDsp">
\[ \frac{U^{2}(h_{d})}{2}=\int_{h_{d}}^{H} N^{2}(z)(H-z)dz \]
</p>
 where \(H\) is the maximum subgrid scale elevation within the grid box of actual orography, \(h\), obtained from the GTOPO30 dataset from the U.S. Geological Survey.</li>
<li>Calculate \(ZLEN\), which sums up a number of contributions of elliptic obstables. <p class="formulaDsp">
\[ ZLEN=\sqrt{[\frac{h_{d}-z}{z+h&#39;}]} \]
</p>
 where \(z\) is the height, \(h&#39;\) is the orographic standard deviation (HPRIME).</li>
<li>Calculate the drag coefficient to vary with the aspect ratio of the obstable as seen by the incident flow (see eq.14 in Lott and Miller (1997) <b>[lott_and_miller_1997]</b>) <p class="formulaDsp">
\[ R=\frac{\cos^{2}\psi+\gamma\sin^{2}\psi}{\gamma\cos^{2}\psi+\sin^{2}\psi} \]
</p>
 where \(\psi\), which is derived from THETA, is the angle between the incident flow direction and the normal ridge direcion. \(\gamma\) is the orographic anisotropy (GAMMA).</li>
<li>In each model layer below the dividing streamlines, a drag from the blocked flow is exerted by the obstacle on the large scale flow. The drag per unit area and per unit height is written (eq.15 in Lott and Miller (1997) <b>[lott_and_miller_1997]</b>): <p class="formulaDsp">
\[ D_{b}(z)=-C_{d}\max(2-\frac{1}{R},0)\rho\frac{\sigma}{2h&#39;}ZLEN\max(\cos\psi,\gamma\sin\psi)\frac{UDS}{2} \]
</p>
 where \(C_{d}\) is a specified constant, \(\sigma\) is the orographic slope. <br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 &mdash; Orographic Gravity Wave Drag Section</li>
<li>Calculate the reference level index: kref=max(2,KPBL+1). where KPBL is the index for the PBL top layer.</li>
<li>Calculate low-level horizontal wind direction, the derived orographic asymmetry parameter (OA), and the derived Lx (CLX). <br />
<br />
<br />
<br />
<br />
<br />
<br />
</li>
<li>Calculate enhancement factor (E),number of mountans (m') and aspect ratio constant. <br />
 As in eq.(4.9),(4.10),(4.11) in Kim and Arakawa (1995) <b>[kim_and_arakawa_1995]</b>, we define m' and E in such a way that they depend on the geometry and location of the subgrid-scale orography through OA and the nonlinearity of flow above the orography through Fr. OC, which is the orographic convexity, and statistically determine how protruded (sharp) the subgrid-scale orography is, is included in the saturation flux G' in such a way that G' is proportional to OC. The forms of E,m' and G' are: <p class="formulaDsp">
\[ E(OA,F_{r_{0}})=(OA+2)^{\delta} \]
</p>
 <p class="formulaDsp">
\[ \delta=C_{E}F_{r_{0}}/F_{r_{c}} \]
</p>
 <p class="formulaDsp">
\[ m&#39;(OA,CLX)=C_{m}\triangle x(1+CLX)^{OA+1} \]
</p>
 <p class="formulaDsp">
\[ G&#39;(OC,F_{r_{0}})=\frac{F_{r_{0}}^2}{F_{r_{0}}^2+a^{2}} \]
</p>
 <p class="formulaDsp">
\[ a^{2}=C_{G}OC^{-1} \]
</p>
 where \(F_{r_{c}}(=1)\) is the critical Froude number, \(F_{r_{0}}\) is the Froude number. \(C_{E}\), \(C_{m}\), \(C_{G}\) are constants.</li>
<li>Calculate the reference-level drag \(\tau_{0}\) (eq.(4.8) in Kim and Arakawa (1995) <b>[kim_and_arakawa_1995]</b>): <p class="formulaDsp">
\[ \tau_0=E\frac{m&#39;}{\triangle x}\frac{\rho_{0}U_0^3}{N_{0}}G&#39; \]
</p>
 where \(E\), \(m&#39;\), and \(G&#39;\) are the enhancement factor, "the number of mountains", and the flux function defined above, respectively.</li>
<li>Compute the drag above the reference level ( \(k\geq kref\)):<ul>
<li>Calculate the ratio of the Scorer parameter ( \(R_{scor}\)). <br />
 From a series of experiments, Kim and Arakawa (1995) <b>[kim_and_arakawa_1995]</b> found that the magnitude of drag divergence tends to be underestimated by the revised scheme in low-level downstream regions with wave breaking. Therefore, at low levels when OA &gt; 0 (i.e., in the "downstream" region) the saturation hypothesis is replaced by the following formula based on the ratio of the the Scorer parameter: <p class="formulaDsp">
\[ R_{scor}=\min \left[\frac{\tau_i}{\tau_{i+1}},1\right] \]
</p>
</li>
<li>The drag above the reference level is expressed as: <p class="formulaDsp">
\[ \tau=\frac{m&#39;}{\triangle x}\rho NUh_d^2 \]
</p>
 where \(h_{d}\) is the displacement wave amplitude. In the absence of wave breaking, the displacement amplitude for the \(i^{th}\) layer can be expressed using the drag for the layer immediately below. Thus, assuming \(\tau_i=\tau_{i+1}\), we can get: <p class="formulaDsp">
\[ h_{d_i}^2=\frac{\triangle x}{m&#39;}\frac{\tau_{i+1}}{\rho_{i}N_{i}U_{i}} \]
</p>
</li>
</ul>
</li>
<li>The minimum Richardson number ( \(Ri_{m}\)) or local wave-modified Richardson number, which determines the onset of wave breaking, is expressed in terms of \(R_{i}\) and \(F_{r_{d}}=Nh_{d}/U\): <p class="formulaDsp">
\[ Ri_{m}=\frac{Ri(1-Fr_{d})}{(1+\sqrt{Ri}\cdot Fr_{d})^{2}} \]
</p>
 see eq.(4.6) in Kim and Arakawa (1995) <b>[kim_and_arakawa_1995]</b>.<ul>
<li>Check stability to employ the 'saturation hypothesis' of Lindzen (1981) <b>[lindzen_1981]</b> except at tropospheric downstream regions. <br />
 Wave breaking occurs when \(Ri_{m}&lt;Ri_{c}=0.25\). Then Lindzen's wave saturation hypothesis resets the displacement amplitude \(h_{d}\) to that corresponding to \(Ri_{m}=0.25\), we obtain the critical \(h_{d}\)(or \(h_{c}\)) expressed in terms of the mean values of \(U\), \(N\), and \(Ri\) ( eq.(4.7) in Kim and Arakawa (1995) <b>[kim_and_arakawa_1995]</b>): <p class="formulaDsp">
\[ h_{c}=\frac{U}{N}\left\{2(2+\frac{1}{\sqrt{Ri}})^{1/2}-(2+\frac{1}{\sqrt{Ri}})\right\} \]
</p>
 if \(Ri_{m}\leq Ri_{c}\), obtain \(\tau\) from the drag above the reference level by using \(h_{c}\) computed above; otherwise \(\tau\) is unchanged (note: scaled by the ratio of the Scorer paramter).</li>
</ul>
</li>
<li>Calculate outputs: A, B, DUSFC, DVSFC (see parameter description).<ul>
<li>Below the dividing streamline height (k &lt; idxzb), mountain blocking( \(D_{b}\)) is applied.</li>
<li>Otherwise (k&gt;= idxzb), orographic GWD ( \(\tau\)) is applied. </li>
</ul>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="gwdps_8f_source.html#l00342">342</a> of file <a class="el" href="gwdps_8f_source.html">gwdps.f</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Oct 14 2019 08:41:11 for FV3DYCORE DOCUMENTATION by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
